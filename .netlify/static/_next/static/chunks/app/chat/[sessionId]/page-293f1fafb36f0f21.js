(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3273],{53172:function(e,t,s){Promise.resolve().then(s.bind(s,40235))},40235:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(57437),a=s(2265),n=s(99376),o=s(47120);function i(){let e=(0,n.useParams)(),t=(0,n.useSearchParams)(),s=(null==e?void 0:e.sessionId)||"",[i,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(""),[d,m]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),f=(0,a.useRef)(null),[p,g]=(0,a.useState)(0),[b,v]=(0,a.useState)(!1),y=(null==t?void 0:t.get("quizId"))||"",w=(null==t?void 0:t.get("band"))||"",j=(null==t?void 0:t.get("score"))||"",N=(null==t?void 0:t.get("maxScore"))||"",D=(0,a.useMemo)(()=>{let e=[];return y&&e.push("quiz=".concat(y)),w&&e.push("band=".concat(w)),j&&N&&e.push("score=".concat(j,"/").concat(N)),e.join(" | ")||"general"},[y,w,j,N]),{trackMessage:k}=((0,a.useEffect)(()=>{(0,o.yw)(s,D||"general")},[s,D]),{trackMessage:e=>{(0,o.DK)(s,e)}});(0,a.useEffect)(()=>{_()},[i]);let _=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},S=(0,a.useCallback)(async()=>{try{let e=w&&j&&N?'I see your result is "'.concat(w,'" with a score of ').concat(j,"/").concat(N,"."):void 0,t=["Hi! I'm here to help you understand your quiz results better.",e,"You can ask up to 6 questions in this session. After that, I'll summarize with a simple, actionable plan for you.","What would you like to explore first?"].filter(Boolean).join("\n\n"),s={role:"assistant",content:t,timestamp:new Date};l([s])}catch(e){console.error("Failed to initialize chat:",e)}},[w,j,N]);(0,a.useEffect)(()=>{S()},[S]);let P=async()=>{if(!c.trim()||d)return;if(b){let e={role:"assistant",content:"You've reached the 6-question limit for this session. You can start a new session from your report or dashboard anytime.",timestamp:new Date};l(t=>[...t,e]);try{k("assistant")}catch(e){}return}let e={id:Date.now().toString(),content:c,role:"user",timestamp:new Date},t=i.filter(e=>"user"===e.role).length+1;l(t=>[...t,e]),u(""),m(!0);try{k("user")}catch(e){}try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:s,message:c,conversationHistory:i})}),r=await e.json(),a={id:(Date.now()+1).toString(),content:r.response||"I apologize, but I encountered an error. Please try asking your question again.",role:"assistant",timestamp:new Date};l(e=>[...e,a]);try{k("assistant")}catch(e){}if(g(t),t>=6){let e={id:(Date.now()+2).toString(),content:function(e,t,s){let r=t&&s?"Score: ".concat(t,"/").concat(s,"."):"";return["Your 4-week plan","",[e?"Band: ".concat(e,"."):"",r].filter(Boolean).join(" "),"","Daily (EMA micro-check-in):","- 2 minutes: note one situation, your reaction, and value alignment (yes/no).","","Weekly:","- Pick one small behavior to align better with a value (eg, honest conversation, screen cutoff).","- Do a 10-min reflection on patterns (justification, belief shift, selective evidence, identity protection, social reality).","","Monthly:","- Review your log. Identify 1–2 repeating patterns and one concrete next habit.","","Tip:","Use a “pause and reflect” cue when you notice instant justification. Ask: “What value matters here?”"].join("\n")}(w,j,N),role:"assistant",timestamp:new Date};l(t=>[...t,e]);try{k("assistant")}catch(e){}v(!0)}}catch(t){console.error("Chat error:",t);let e={id:(Date.now()+3).toString(),content:"I apologize, but I encountered an error. Please try asking your question again.",role:"assistant",timestamp:new Date};l(t=>[...t,e])}finally{m(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-primary/5 relative overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,r.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-primary/10 to-purple-500/10 rounded-full blur-3xl animate-float"}),(0,r.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-500/10 to-cyan-500/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),(0,r.jsx)("div",{className:"relative glass border-b border-white/20 backdrop-blur-xl supports-[backdrop-filter]:bg-white/80 px-4 py-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-primary to-purple-600 rounded-2xl flex items-center justify-center text-white text-xl shadow-soft",children:"\uD83E\uDD16"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"AI Results Discussion"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Get personalized insights about your quiz results and next steps"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83E\uDDE0"}),"Contextual AI"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDD12"}),"Private & Secure"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCA1"}),"Actionable Insights"]})]})]})}),(0,r.jsx)("div",{className:"relative flex-1 overflow-y-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.map((e,t)=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"," animate-fade-in"),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3 max-w-3xl ".concat("user"===e.role?"flex-row-reverse space-x-reverse":""),children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm flex-shrink-0 ".concat("user"===e.role?"bg-gradient-to-br from-primary to-purple-600 text-white":"bg-gradient-to-br from-emerald-500 to-teal-600 text-white"),children:"user"===e.role?"\uD83D\uDC64":"\uD83E\uDD16"}),(0,r.jsxs)("div",{className:"px-6 py-4 rounded-2xl shadow-soft transition-all duration-200 hover:shadow-medium ".concat("user"===e.role?"bg-gradient-to-br from-primary to-purple-600 text-white":"bg-white border border-border text-foreground"),children:[(0,r.jsx)("div",{className:"whitespace-pre-wrap leading-relaxed",children:e.content}),(0,r.jsx)("div",{className:"text-xs mt-3 ".concat("user"===e.role?"text-white/70":"text-muted-foreground"),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},t)),d&&(0,r.jsx)("div",{className:"flex justify-start animate-fade-in",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3 max-w-3xl",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center text-sm text-white",children:"\uD83E\uDD16"}),(0,r.jsx)("div",{className:"bg-white border border-border rounded-2xl px-6 py-4 shadow-soft",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),(0,r.jsx)("div",{ref:f})]})}),(0,r.jsx)("div",{className:"relative glass border-t border-white/20 backdrop-blur-xl supports-[backdrop-filter]:bg-white/80 px-4 py-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),P())},placeholder:"Ask me about your results, patterns, or what you should do next...",className:"w-full px-6 py-4 border border-border rounded-2xl focus:ring-2 focus:ring-primary focus:border-primary resize-none shadow-soft bg-white/90 backdrop-blur-sm transition-all duration-200 placeholder:text-muted-foreground",rows:2,disabled:d}),(0,r.jsx)("div",{className:"absolute bottom-3 right-3 text-xs text-muted-foreground",children:"Press Enter to send"})]}),(0,r.jsx)("button",{onClick:P,disabled:!c.trim()||d,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-600 text-white font-semibold rounded-2xl shadow-glow hover:shadow-glow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-300 flex items-center",children:d?(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mr-2",children:"Send"}),(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground font-medium mb-2 w-full",children:"\uD83D\uDCA1 Quick suggestions:"}),["What does my score mean?","How can I improve?","What should I focus on?","Show me patterns in my results"].map(e=>(0,r.jsx)("button",{onClick:()=>u(e),className:"px-3 py-2 text-xs bg-primary/10 text-primary rounded-full border border-primary/20 hover:bg-primary/20 transition-colors duration-200",children:e},e))]})]})})]})}},47120:function(e,t,s){"use strict";s.d(t,{DK:function(){return c},D_:function(){return o},LV:function(){return a},Tf:function(){return i},vt:function(){return r},yw:function(){return l}});let r="your-google-analytics-id",a=e=>{window.gtag&&r&&window.gtag("config",r,{page_path:e})},n=(e,t)=>{window.gtag&&window.gtag("event",e,t)},o=e=>{n("blog_like",{blog_id:e,event_category:"engagement",event_label:e})},i=(e,t)=>{n("purchase",{transaction_id:"sub_".concat(Date.now()),value:t,currency:"USD",items:[{item_id:"subscription",item_name:"".concat(e," Subscription"),category:"subscription",price:t,quantity:1}],event_category:"conversion"})},l=(e,t)=>{n("ai_chat_start",{session_id:e,chat_context:t,event_category:"ai_interaction"})},c=(e,t)=>{n("ai_chat_message",{session_id:e,message_type:t,event_category:"ai_interaction"})}},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"notFound")&&s.d(t,{notFound:function(){return r.notFound}}),s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=53172)}),_N_E=e.O()}]);