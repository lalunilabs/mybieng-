(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3273],{53172:function(e,t,r){Promise.resolve().then(r.bind(r,40235))},40235:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=r(57437),s=r(2265),n=r(99376),i=r(47120);function o(){let e=(0,n.useParams)(),t=(0,n.useSearchParams)(),r=(null==e?void 0:e.sessionId)||"",[o,l]=(0,s.useState)([]),[c,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),[h,x]=(0,s.useState)(null),f=(0,s.useRef)(null),[p,g]=(0,s.useState)(0),[y,b]=(0,s.useState)(!1),v=(null==t?void 0:t.get("quizId"))||"",w=(null==t?void 0:t.get("band"))||"",j=(null==t?void 0:t.get("score"))||"",_=(null==t?void 0:t.get("maxScore"))||"",D=(0,s.useMemo)(()=>{let e=[];return v&&e.push("quiz=".concat(v)),w&&e.push("band=".concat(w)),j&&_&&e.push("score=".concat(j,"/").concat(_)),e.join(" | ")||"general"},[v,w,j,_]),{trackMessage:N}=((0,s.useEffect)(()=>{(0,i.yw)(r,D||"general")},[r,D]),{trackMessage:e=>{(0,i.DK)(r,e)}});(0,s.useEffect)(()=>{k()},[o]);let k=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},S=(0,s.useCallback)(async()=>{try{let e=w&&j&&_?'I see your result is "'.concat(w,'" with a score of ').concat(j,"/").concat(_,"."):void 0,t=["Hi! I'm here to help you understand your quiz results better.",e,"You can ask up to 6 questions in this session. After that, I'll summarize with a simple, actionable plan for you.","What would you like to explore first?"].filter(Boolean).join("\n\n"),r={role:"assistant",content:t,timestamp:new Date};l([r])}catch(e){console.error("Failed to initialize chat:",e)}},[w,j,_]);(0,s.useEffect)(()=>{S()},[S]);let q=async()=>{if(!c.trim()||d)return;if(y){let e={role:"assistant",content:"You've reached the 6-question limit for this session. You can start a new session from your report or dashboard anytime.",timestamp:new Date};l(t=>[...t,e]);try{N("assistant")}catch(e){}return}let e={id:Date.now().toString(),content:c,role:"user",timestamp:new Date},t=o.filter(e=>"user"===e.role).length+1;l(t=>[...t,e]),u(""),m(!0);try{N("user")}catch(e){}try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:r,message:c,conversationHistory:o})}),a=await e.json(),s={id:(Date.now()+1).toString(),content:a.response||"I apologize, but I encountered an error. Please try asking your question again.",role:"assistant",timestamp:new Date};l(e=>[...e,s]);try{N("assistant")}catch(e){}if(g(t),t>=6){let e={id:(Date.now()+2).toString(),content:function(e,t,r){let a=t&&r?"Score: ".concat(t,"/").concat(r,"."):"";return["Your 4-week plan","",[e?"Band: ".concat(e,"."):"",a].filter(Boolean).join(" "),"","Daily (EMA micro-check-in):","- 2 minutes: note one situation, your reaction, and value alignment (yes/no).","","Weekly:","- Pick one small behavior to align better with a value (eg, honest conversation, screen cutoff).","- Do a 10-min reflection on patterns (justification, belief shift, selective evidence, identity protection, social reality).","","Monthly:","- Review your log. Identify 1–2 repeating patterns and one concrete next habit.","","Tip:","Use a “pause and reflect” cue when you notice instant justification. Ask: “What value matters here?”"].join("\n")}(w,j,_),role:"assistant",timestamp:new Date};l(t=>[...t,e]);try{N("assistant")}catch(e){}b(!0)}}catch(t){console.error("Chat error:",t);let e={id:(Date.now()+3).toString(),content:"I apologize, but I encountered an error. Please try asking your question again.",role:"assistant",timestamp:new Date};l(t=>[...t,e])}finally{m(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-primary/5 relative overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,a.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-primary/10 to-purple-500/10 rounded-full blur-3xl animate-float"}),(0,a.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-500/10 to-cyan-500/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),(0,a.jsx)("div",{className:"relative glass border-b border-white/20 backdrop-blur-xl supports-[backdrop-filter]:bg-white/80 px-4 py-6",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-primary to-purple-600 rounded-2xl flex items-center justify-center text-white text-xl shadow-soft",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"AI Results Discussion"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Get personalized insights about your quiz results and next steps"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83E\uDDE0"}),"Contextual AI"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDD12"}),"Private & Secure"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCA1"}),"Actionable Insights"]})]})]})}),(0,a.jsx)("div",{className:"relative flex-1 overflow-y-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[o.map((e,t)=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"," animate-fade-in"),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3 max-w-3xl ".concat("user"===e.role?"flex-row-reverse space-x-reverse":""),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm flex-shrink-0 ".concat("user"===e.role?"bg-gradient-to-br from-primary to-purple-600 text-white":"bg-gradient-to-br from-emerald-500 to-teal-600 text-white"),children:"user"===e.role?"\uD83D\uDC64":"\uD83E\uDD16"}),(0,a.jsxs)("div",{className:"px-6 py-4 rounded-2xl shadow-soft transition-all duration-200 hover:shadow-medium ".concat("user"===e.role?"bg-gradient-to-br from-primary to-purple-600 text-white":"bg-white border border-border text-foreground"),children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap leading-relaxed",children:e.content}),(0,a.jsx)("div",{className:"text-xs mt-3 ".concat("user"===e.role?"text-white/70":"text-muted-foreground"),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},t)),d&&(0,a.jsx)("div",{className:"flex justify-start animate-fade-in",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3 max-w-3xl",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center text-sm text-white",children:"\uD83E\uDD16"}),(0,a.jsx)("div",{className:"bg-white border border-border rounded-2xl px-6 py-4 shadow-soft",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),(0,a.jsx)("div",{ref:f})]})}),(0,a.jsx)("div",{className:"relative glass border-t border-white/20 backdrop-blur-xl supports-[backdrop-filter]:bg-white/80 px-4 py-6",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),q())},placeholder:"Ask me about your results, patterns, or what you should do next...",className:"w-full px-6 py-4 border border-border rounded-2xl focus:ring-2 focus:ring-primary focus:border-primary resize-none shadow-soft bg-white/90 backdrop-blur-sm transition-all duration-200 placeholder:text-muted-foreground",rows:2,disabled:d}),(0,a.jsx)("div",{className:"absolute bottom-3 right-3 text-xs text-muted-foreground",children:"Press Enter to send"})]}),(0,a.jsx)("button",{onClick:q,disabled:!c.trim()||d,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-600 text-white font-semibold rounded-2xl shadow-glow hover:shadow-glow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all duration-300 flex items-center",children:d?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"mr-2",children:"Send"}),(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground font-medium mb-2 w-full",children:"\uD83D\uDCA1 Quick suggestions:"}),["What does my score mean?","How can I improve?","What should I focus on?","Show me patterns in my results"].map(e=>(0,a.jsx)("button",{onClick:()=>u(e),className:"px-3 py-2 text-xs bg-primary/10 text-primary rounded-full border border-primary/20 hover:bg-primary/20 transition-colors duration-200",children:e},e))]})]})})]})}},47120:function(e,t,r){"use strict";r.d(t,{$y:function(){return x},DK:function(){return h},D_:function(){return c},LV:function(){return s},PZ:function(){return l},Tf:function(){return u},VH:function(){return d},Z_:function(){return f},kW:function(){return o},vt:function(){return a},yw:function(){return m},z9:function(){return i}});let a="your-google-analytics-id",s=e=>{window.gtag&&a&&window.gtag("config",a,{page_path:e})},n=(e,t)=>{window.gtag&&window.gtag("event",e,t)},i=(e,t)=>{n("quiz_start",{quiz_id:e,quiz_name:t,event_category:"quiz",event_label:e})},o=(e,t,r)=>{n("quiz_progress",{quiz_id:e,question_number:t,total_questions:r,progress_percentage:Math.round(t/r*100),event_category:"quiz"})},l=(e,t,r)=>{n("quiz_complete",{quiz_id:e,score:t,time_spent_seconds:r,event_category:"quiz",event_label:e})},c=e=>{n("blog_like",{blog_id:e,event_category:"engagement",event_label:e})},u=(e,t)=>{n("purchase",{transaction_id:"sub_".concat(Date.now()),value:t,currency:"USD",items:[{item_id:"subscription",item_name:"".concat(e," Subscription"),category:"subscription",price:t,quantity:1}],event_category:"conversion"})},d=(e,t)=>{n("purchase",{transaction_id:"quiz_".concat(e,"_").concat(Date.now()),value:t,currency:"USD",items:[{item_id:e,item_name:"Quiz: ".concat(e),category:"quiz_purchase",price:t,quantity:1}],event_category:"conversion"})},m=(e,t)=>{n("ai_chat_start",{session_id:e,chat_context:t,event_category:"ai_interaction"})},h=(e,t)=>{n("ai_chat_message",{session_id:e,message_type:t,event_category:"ai_interaction"})},x=(e,t,r,a)=>{n("view_item",{currency:"USD",value:a,items:[{item_id:e,item_name:t,category:r,price:a,quantity:1}]})},f=e=>{n("begin_checkout",{currency:"USD",value:e.reduce((e,t)=>e+t.price,0),items:e.map(e=>({item_id:e.id,item_name:e.name,category:e.category,price:e.price,quantity:1}))})}},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=53172)}),_N_E=e.O()}]);