"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5555],{65555:function(e,s,t){t.d(s,{l:function(){return w}});var r=t(57437),a=t(2265),l=t(55520),i=t(84226),n=t(93196),o=t(67441),d=t(99178),c=t(175),m=t(96215),x=t(82718),u=t(41671),h=t(82023),p=t(89345),b=t(99376),g=t(80605),j=t(5095),f=t(32489),N=t(97611),v=t(30087);function y(e){let{isOpen:s,onClose:t,score:d,maxScore:c,band:m,quizTitle:u,quizSlug:h,responses:g,onEmailReport:y}=e,[w,S]=(0,a.useState)(""),[z,k]=(0,a.useState)(!1),C=(0,b.useRouter)();return(0,r.jsx)(j.M,{children:s&&(0,r.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:(0,r.jsxs)(l.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-white rounded-2xl shadow-2xl",children:[(0,r.jsx)("button",{onClick:t,"aria-label":"Close modal",className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition-colors z-10",children:(0,r.jsx)(f.Z,{className:"w-5 h-5 text-gray-500"})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)(N.QuizReportVisualization,{score:d,maxScore:c,band:m,quizTitle:u,quizSlug:h,responses:g,onRetake:()=>{t()},onShare:()=>{}}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsxs)(v.default,{surface:"report_modal",eventName:"report_chat_start",variant:"uiverse",onClick:()=>{var e,s,t;let r=(null===(t=globalThis)||void 0===t?void 0:null===(s=t.crypto)||void 0===s?void 0:null===(e=s.randomUUID)||void 0===e?void 0:e.call(s))||Math.random().toString(36).slice(2),a=new URLSearchParams({quizId:h,band:m.label,score:String(d),maxScore:String(c)});C.push("/chat/".concat(r,"?").concat(a.toString()))},children:[(0,r.jsx)(x.Z,{className:"w-4 h-4 mr-2"})," Ask AI about this report"]})}),(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.7},className:"mt-8 p-6 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl border border-purple-200",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Get Your Detailed Report"}),(0,r.jsx)("p",{className:"text-gray-700 mb-4",children:"Enter your email to receive a detailed report with personalized insights and recommendations."}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),w&&(y(w),k(!0),setTimeout(()=>{k(!1),S("")},3e3))},className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)(n._,{htmlFor:"report-email",className:"sr-only",children:"Email address"}),(0,r.jsx)(o.I,{id:"report-email",type:"email",value:w,onChange:e=>S(e.target.value),placeholder:"your.email@example.com",className:"h-12 px-4 rounded-lg focus-visible:ring-brand-500",required:!0})]}),(0,r.jsx)(i.z,{type:"submit",variant:"gradient",className:"whitespace-nowrap",disabled:z,children:z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Sent!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Email Report"]})})]})]})]})]})})})}function w(e){let{sessionId:s,quizId:t,quizTitle:j,quizSlug:f,responses:N,score:w,maxScore:S,onComplete:z}=e,[k,C]=(0,a.useState)(""),[E,R]=(0,a.useState)(!1),[Z,q]=(0,a.useState)(!1),[T,F]=(0,a.useState)(null),[A,I]=(0,a.useState)(!1),[_,O]=(0,a.useState)(f||t),[Y,D]=(0,a.useState)(Array.isArray(N)?N:[]),[M,P]=(0,a.useState)(!1),Q=(0,b.useRouter)(),{data:U}=(0,g.useSession)();(0,a.useEffect)(()=>{F((0,c.tF)(w,S)),!Array.isArray(N)&&t&&D([])},[w,S,t,N]);let G=async e=>{e.preventDefault(),R(!0);try{if(!(await fetch("/api/quiz/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:s,quizId:t,responses:Y,score:w})})).ok)throw Error("Failed to submit quiz");if(k&&!(await fetch("/api/quiz/email-results",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:k,quizId:t,quizTitle:j,score:w,maxScore:S,band:null==T?void 0:T.label})})).ok)throw Error("Failed to send email");q(!0),U||P(!0)}catch(e){console.error("Error submitting quiz:",e)}finally{R(!1)}},J=async e=>{try{if(!(await fetch("/api/quiz/email-results",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,quizId:t,quizTitle:j,score:w,maxScore:S,band:null==T?void 0:T.label})})).ok)throw Error("Failed to send email");q(!0)}catch(e){console.error("Error sending email:",e)}};return U&&T?(Q.push("/dashboard"),null):A&&T?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-purple-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Your ",j," Report"]}),(0,r.jsx)(i.z,{onClick:()=>U?Q.push("/dashboard"):I(!1),variant:"outline",children:U?"Back to Dashboard":"Back to Results"})]}),(0,r.jsx)(d.Zb,{className:"mb-8",children:(0,r.jsxs)(d.aY,{className:"p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(m.Z,{className:"w-12 h-12 text-white"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Quiz Complete!"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Here's your personalized report with insights and recommendations."}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-8 mb-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:w}),(0,r.jsx)("div",{className:"text-gray-600",children:"Your Score"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-pink-600",children:[Math.round(w/S*100),"%"]}),(0,r.jsx)("div",{className:"text-gray-600",children:"Percentile"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:T.label}),(0,r.jsx)("div",{className:"text-gray-600",children:"Category"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 mb-8 border border-purple-200",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-purple-900 mb-4",children:"What This Means"}),(0,r.jsx)("p",{className:"text-purple-800 mb-4",children:null==T?void 0:T.advice})]}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-4",children:[(0,r.jsx)(i.z,{onClick:()=>U?Q.push("/dashboard"):Q.push("/"),variant:"gradient",children:U?"View All Reports":"Take Another Quiz"}),(0,r.jsx)(i.z,{variant:"outline",onClick:()=>Q.push("/quizzes/".concat(_)),children:"Retake Quiz"})]})]})}),(0,r.jsxs)(d.Zb,{children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5"}),"Want Deeper Insights?"]}),(0,r.jsx)(d.SZ,{children:"Continue your journey with personalized guidance"})]}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,r.jsx)("p",{className:"flex-grow text-gray-700",children:"Explore your results in depth with our AI-powered insights session."}),(0,r.jsxs)(v.default,{variant:"uiverse",className:"whitespace-nowrap",onClick:()=>{let e=new URLSearchParams({quizId:String(_),band:String((null==T?void 0:T.label)||""),score:String(w),maxScore:String(S)});Q.push("/chat/".concat(s,"?").concat(e.toString()))},children:[(0,r.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"Start AI Session"]})]})})]})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 py-12 px-4",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl",children:(0,r.jsx)(u.Z,{className:"w-12 h-12 text-white"})}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Quiz Complete!"}),(0,r.jsxs)("p",{className:"text-lg text-gray-600 mb-10 max-w-xl mx-auto",children:["Great job completing the ",j,". Here's a quick summary of your results."]}),(0,r.jsx)(d.Zb,{className:"mb-8 bg-gradient-to-br from-white to-purple-50 border-2 border-purple-200 shadow-lg rounded-2xl overflow-hidden",children:(0,r.jsxs)(d.aY,{className:"p-6 md:p-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"text-center bg-gradient-to-br from-purple-50 to-white rounded-xl p-4 border border-purple-100",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:w}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Your Score"})]}),(0,r.jsxs)("div",{className:"text-center bg-gradient-to-br from-indigo-50 to-white rounded-xl p-4 border border-indigo-100",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-indigo-600 mb-1",children:[Math.round(w/S*100),"%"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Percentile"})]}),T&&(0,r.jsxs)("div",{className:"text-center bg-gradient-to-br from-pink-50 to-white rounded-xl p-4 border border-pink-100",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-pink-600 mb-1",children:T.label}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Category"})]})]}),T&&(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl p-6 mb-6 border border-purple-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 text-purple-600"}),(0,r.jsx)("h3",{className:"text-lg font-bold text-purple-900",children:"What This Means"})]}),(0,r.jsx)("p",{className:"text-purple-800",children:T.advice})]}),(0,r.jsxs)(i.z,{onClick:()=>I(!0),variant:"gradient",className:"rounded-xl py-2.5 font-medium px-6",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5 mr-2"}),"View Detailed Report"]})]})}),!U&&(0,r.jsxs)(d.Zb,{className:"mb-8 bg-gradient-to-br from-blue-50 to-cyan-50 border border-blue-200 rounded-2xl overflow-hidden",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2 text-blue-900",children:[(0,r.jsx)(p.Z,{className:"w-5 h-5"}),"Get Your Results"]}),(0,r.jsx)(d.SZ,{className:"text-blue-800",children:"Enter your email to receive a detailed report with personalized insights and recommendations."})]}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n._,{htmlFor:"email",className:"text-blue-900",children:"Email Address"}),(0,r.jsx)(o.I,{id:"email",type:"email",value:k,onChange:e=>C(e.target.value),placeholder:"your.email@example.com",className:"h-12 px-4 rounded-xl focus-visible:ring-brand-500",required:!0})]}),(0,r.jsx)(i.z,{type:"submit",disabled:E||Z,variant:"gradient",className:"w-full rounded-xl py-2.5 font-medium",children:E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),"Sending..."]}):Z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Report Sent!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Email My Detailed Report"]})})]})})]})]})})}),T&&(0,r.jsx)(y,{isOpen:M,onClose:()=>{P(!1),Q.push("/")},score:w,maxScore:S,band:T,quizTitle:j,quizSlug:_,responses:Y,onEmailReport:J})]})}},67441:function(e,s,t){t.d(s,{I:function(){return i}});var r=t(57437),a=t(2265),l=t(94508);let i=a.forwardRef((e,s)=>{let{className:t,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});i.displayName="Input"},93196:function(e,s,t){t.d(s,{_:function(){return n}});var r=t(57437),a=t(2265),l=t(39144),i=t(94508);let n=a.forwardRef((e,s)=>{let{className:t,children:a,hint:n,...o}=e;return(0,r.jsxs)(l.f,{ref:s,className:(0,i.cn)("block text-sm font-medium text-gray-700",t),...o,children:[a,n?(0,r.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:n}):null]})});n.displayName="Label"}}]);