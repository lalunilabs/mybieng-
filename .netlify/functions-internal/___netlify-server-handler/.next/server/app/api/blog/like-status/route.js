"use strict";(()=>{var e={};e.id=6393,e.ids=[6393],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},99880:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>y,patchFetch:()=>z,requestAsyncStorage:()=>l,routeModule:()=>o,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m});var n={};i.r(n),i.d(n,{GET:()=>d});var a=i(49303),s=i(88716),r=i(60670),u=i(87070),c=i(86287);async function d(e){try{let{searchParams:t}=new URL(e.url),i=t.get("email"),n=t.get("articleId");if(!i||!n)return u.NextResponse.json({error:"Missing email or articleId"},{status:400});let a=await (0,c.Z1)(i,n);return u.NextResponse.json({isLiked:a})}catch(e){return console.error("Like status API error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let o=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/blog/like-status/route",pathname:"/api/blog/like-status",filename:"route",bundlePath:"app/api/blog/like-status/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/blog/like-status/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:p}=o,y="/api/blog/like-status/route";function z(){return(0,r.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:m})}},9487:(e,t,i)=>{i.d(t,{_:()=>s,s:()=>r});var n=i(53524);let a=()=>({user:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-user",...e}),count:async()=>0},quizRun:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-run",...e}),count:async()=>0,update:async()=>({}),updateMany:async()=>({})},quizAnswer:{findMany:async()=>[],create:async e=>({id:"mock-answer",...e}),createMany:async()=>({count:0})},subscription:{findUnique:async()=>null,findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-sub",...e}),update:async({data:e})=>({id:"mock-sub",...e}),upsert:async({create:e,update:t})=>({id:"mock-sub",...t||e}),delete:async()=>({})},manualDiscount:{findFirst:async()=>null,update:async({data:e})=>({id:"mock-discount",...e}),create:async({data:e})=>({id:"mock-discount",...e})},purchase:{findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-purchase",...e}),count:async()=>0},emailLog:{create:async({data:e})=>({id:"mock-email",status:e?.status||"sent",...e}),update:async({where:e,data:t})=>({id:e?.id||"mock-email",...t}),findMany:async()=>[]},newsletter:{create:async e=>({id:"mock-subscriber",...e}),count:async()=>0},$connect:async()=>{},$disconnect:async()=>{},$transaction:async e=>e(void 0)}),s=globalThis.prisma??function(){if(!process.env.DATABASE_URL)return console.warn("No DATABASE_URL found - using mock client"),a();try{return new n.PrismaClient({log:["error"],datasources:{db:{url:process.env.DATABASE_URL}}})}catch(e){return console.error("Failed to create Prisma client:",e),a()}}();async function r(e,t){if(!s)return console.warn("Database not available - returning fallback value"),t;try{return await e()}catch(e){return console.error("Database operation failed:",e),t}}},86287:(e,t,i)=>{i.d(t,{C2:()=>b,EO:()=>w,F3:()=>f,F6:()=>o,FR:()=>l,HA:()=>A,XW:()=>s,Xt:()=>p,Z1:()=>g,cv:()=>d,gL:()=>y,kk:()=>Q,m2:()=>h,qZ:()=>m,rz:()=>c,uF:()=>u,vQ:()=>z,vS:()=>r});var n=i(9487);let a={premiumArticlesLimit:3,freeQuizzesLimit:2,freeQuizValueCap:50,articleDiscountPercent:30,quizDiscountPercent:20,discountedQuizzesLimit:3};async function s(e,t,i,s){let r=new Date,u=new Date(r.getTime()+2592e6);return await n._.subscription.create({data:{userId:e,plan:"premium",status:"active",stripeCustomerId:t,stripeSubscriptionId:i,stripePriceId:s,startDate:r,endDate:u,currentPeriodStart:r,currentPeriodEnd:u,premiumArticlesUsed:0,premiumArticlesLimit:a.premiumArticlesLimit,freeQuizzesUsed:0,freeQuizzesLimit:a.freeQuizzesLimit,freeQuizValueCap:a.freeQuizValueCap,discountedQuizzesUsed:0,discountedQuizzesLimit:a.discountedQuizzesLimit,lastCycleReset:r}})}async function r(e){var t,i;let a=await n._.subscription.findUnique({where:{userId:e}});return a&&"active"===a.status?(t=new Date,i=a.lastCycleReset,t.getUTCFullYear()!==i.getUTCFullYear()||t.getUTCMonth()!==i.getUTCMonth())?await U(a.id):a:null}async function u(e){return await n._.subscription.findUnique({where:{stripeSubscriptionId:e}})}async function c(e){let t=await r(e);return!!t&&t.endDate>new Date&&"active"===t.status}async function d(e){let t=await r(e);return!!t&&t.premiumArticlesUsed<t.premiumArticlesLimit}async function o(e){let t=await r(e);return!!(t&&await d(e))&&(await n._.subscription.update({where:{id:t.id},data:{premiumArticlesUsed:{increment:1}}}),!0)}async function l(e,t){return await r(e)?await d(e)?0:Math.round(t*(1-a.articleDiscountPercent/100)*100)/100:null}async function m(e,t){let i=await r(e);return!!i&&i.freeQuizzesUsed<i.freeQuizzesLimit&&t<=i.freeQuizValueCap}async function p(e,t){let i=await r(e);return i?await m(e,t)?0:i.discountedQuizzesUsed<i.discountedQuizzesLimit?Math.round(t*(1-a.quizDiscountPercent/100)*100)/100:t:null}async function y(e){let t=await r(e);return!!t&&t.discountedQuizzesUsed<t.discountedQuizzesLimit&&(await n._.subscription.update({where:{id:t.id},data:{discountedQuizzesUsed:{increment:1}}}),!0)}async function z(e){let t=await r(e);return!!t&&t.freeQuizzesUsed<t.freeQuizzesLimit&&(await n._.subscription.update({where:{id:t.id},data:{freeQuizzesUsed:{increment:1}}}),!0)}async function f(e){let t=await r(e);return t?{plan:t.plan,status:t.status,premiumArticlesUsed:t.premiumArticlesUsed,premiumArticlesRemaining:t.premiumArticlesLimit-t.premiumArticlesUsed,freeQuizzesUsed:t.freeQuizzesUsed,freeQuizzesRemaining:t.freeQuizzesLimit-t.freeQuizzesUsed,freeQuizValueCap:t.freeQuizValueCap,discountedQuizzesUsed:t.discountedQuizzesUsed,discountedQuizzesRemaining:t.discountedQuizzesLimit-t.discountedQuizzesUsed,endDate:t.endDate,currentPeriodEnd:t.currentPeriodEnd,daysRemaining:Math.ceil((t.endDate.getTime()-Date.now())/864e5),cancelAtPeriodEnd:t.cancelAtPeriodEnd}:null}async function w(e,t=!0){let i=await r(e);return!!i&&(await n._.subscription.update({where:{id:i.id},data:{cancelAtPeriodEnd:t,canceledAt:new Date,...t?{}:{status:"cancelled",endDate:new Date}}}),!0)}async function U(e){let t=new Date,i=new Date(t.getTime()+2592e6);return await n._.subscription.update({where:{id:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:t,currentPeriodStart:t,currentPeriodEnd:i}})}async function Q(e,t){let i=await u(e);return i?await n._.subscription.update({where:{id:i.id},data:t}):null}async function g(e,t){return!1}async function A(e,t){return!0}async function b(e,t){return!0}async function h(e){return!!await r(e)&&(await n._.subscription.update({where:{userId:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:new Date}}),!0)}}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),n=t.X(0,[8948,5972],()=>i(99880));module.exports=n})();