"use strict";(()=>{var e={};e.id=7840,e.ids=[7840],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},6397:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{POST:()=>c});var s=t(49303),a=t(88716),i=t(60670),o=t(87070),u=t(6659),l=t(71615),d=t(65630);async function c(e){try{let r;try{r=await e.json()}catch{return o.NextResponse.json({error:"Invalid JSON in request body"},{status:400,headers:{"Cache-Control":"no-store"}})}let t=d.Ry({email:d.Z_().email(),password:d.Z_().min(1).max(256)}).safeParse(r);if(!t.success)return o.NextResponse.json({error:"Invalid credentials format",details:t.error.flatten()},{status:400,headers:{"Cache-Control":"no-store"}});let n=await (0,u.v9)(t.data.email,t.data.password);return(0,l.cookies)().set("admin_token",n.token,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:86400,path:"/"}),new o.NextResponse(JSON.stringify({success:!0,user:{id:n.user.id,email:n.user.email,name:n.user.name,role:n.user.role,permissions:n.user.permissions}}),{headers:{"Content-Type":"application/json","Cache-Control":"no-store"}})}catch(e){if(e instanceof u.p$)return o.NextResponse.json({error:e.message,code:e.code},{status:401,headers:{"Cache-Control":"no-store"}});return console.error("Admin login error:",e),o.NextResponse.json({error:"Internal server error"},{status:500,headers:{"Cache-Control":"no-store"}})}}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/auth/login/route",pathname:"/api/admin/auth/login",filename:"route",bundlePath:"app/api/admin/auth/login/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/admin/auth/login/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:f}=p,g="/api/admin/auth/login/route";function x(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},6659:(e,r,t)=>{t.d(r,{Wg:()=>h,p$:()=>p,v9:()=>m,vN:()=>f});var n=t(71615),s=t(41482),a=t.n(s),i=t(84770);let o={super_admin:["users.read","users.write","users.delete","content.read","content.write","content.delete","subscriptions.read","subscriptions.write","ai_chat.read","ai_chat.moderate","system.read","system.write","analytics.read","reports.read","reports.export","settings.read","settings.write","security.read","security.write","admin.manage"]},u=process.env.OWNER_EMAIL||"",l=process.env.ADMIN_PASSWORD||"",d=Number(process.env.ADMIN_SESSION_TIMEOUT||"86400"),c=Number.isFinite(d)&&d>0?1e3*d:864e5;class p extends Error{constructor(e,r){super(e),this.code=r,this.name="AdminAuthError"}}async function m(e,r){if(!u||!l)throw new p("Admin not configured","ADMIN_NOT_CONFIGURED");let t=Buffer.from(e),n=Buffer.from(u),s=Buffer.from(r),d=Buffer.from(l),m=t.length===n.length&&(0,i.timingSafeEqual)(t,n),h=s.length===d.length&&(0,i.timingSafeEqual)(s,d);if(!m||!h)throw new p("Invalid credentials","INVALID_CREDENTIALS");let f={id:"admin_owner",email:u,name:u.split("@")[0],role:"super_admin",permissions:o.super_admin,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},g=a().sign({userId:f.id,email:f.email,role:f.role},function(){let e=process.env.ADMIN_JWT_SECRET;if(!e||e.length<16)throw new p("Admin not configured","ADMIN_NOT_CONFIGURED");return e}(),{expiresIn:`${Math.floor(c/1e3)}s`});return{user:f,token:g,expiresAt:new Date(Date.now()+c).toISOString()}}async function h(e){try{let r=process.env.ADMIN_JWT_SECRET;if(!r)return null;let t=a().verify(e,r);if(!t?.email||t.email!==u)return null;return{id:"admin_owner",email:u,name:u.split("@")[0],role:"super_admin",permissions:o.super_admin,createdAt:"2023-01-01T00:00:00Z",lastLogin:new Date().toISOString()}}catch(e){return null}}async function f(){try{let e=(0,n.cookies)(),r=e.get("admin_token")?.value;if(!r)return null;return await h(r)}catch(e){return null}}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,5972,4261,5630],()=>t(6397));module.exports=n})();