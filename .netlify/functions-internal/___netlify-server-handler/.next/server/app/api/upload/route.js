"use strict";(()=>{var e={};e.id=5998,e.ids=[5998],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},26238:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>c});var a={};r.r(a),r.d(a,{POST:()=>u});var o=r(49303),s=r(88716),i=r(60670),n=r(87070),p=r(85662);async function u(e){try{let t=(await e.formData()).get("file");if(!t)return n.NextResponse.json({error:"No file uploaded"},{status:400});let r=["image/jpeg","image/jpg","image/png","image/gif","image/webp"];if(!r.includes(t.type))return n.NextResponse.json({error:"Invalid file type"},{status:400});if(t.size>5242880)return n.NextResponse.json({error:"File too large"},{status:400});let a=(0,p.S)();if(!a)return n.NextResponse.json({error:"Storage not configured"},{status:500});let o=await t.arrayBuffer(),s=new Blob([o],{type:t.type}),i=new Date,u=i.getFullYear(),l=String(i.getMonth()+1).padStart(2,"0"),d=String(i.getDate()).padStart(2,"0"),c=`${u}/${l}/${d}`,g=Math.random().toString(36).slice(2),f=(()=>{let e=t.name,r=e?e.split(".").pop():"";if(r)return r.toLowerCase();switch(t.type){case"image/jpeg":case"image/jpg":return"jpg";case"image/png":return"png";case"image/gif":return"gif";case"image/webp":return"webp";default:return"bin"}})(),m=`${Date.now()}-${g}.${f}`,S=process.env.SUPABASE_STORAGE_BUCKET||"uploads",x=`${c}/${m}`;try{let{data:e}=await a.storage.getBucket(S);e||await a.storage.createBucket(S,{public:!0,fileSizeLimit:"5242880",allowedMimeTypes:r})}catch{}let{error:h}=await a.storage.from(S).upload(x,s,{contentType:t.type,cacheControl:"3600",upsert:!1});if(h)return n.NextResponse.json({error:"Upload failed",details:h.message},{status:500});let{data:y}=a.storage.from(S).getPublicUrl(x),w=y?.publicUrl||"";if(!w)try{let{data:e}=await a.storage.from(S).createSignedUrl(x,604800);e?.signedUrl&&(w=e.signedUrl)}catch{}return n.NextResponse.json({success:!0,imageUrl:w,filename:x})}catch(e){return console.error("Upload error:",e),n.NextResponse.json({error:"Upload failed"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/upload/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:g}=l,f="/api/upload/route";function m(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:c})}},85662:(e,t,r)=>{r.d(t,{S:()=>o});var a=r(69498);function o(){let e=process.env.SUPABASE_URL,t=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_ANON_KEY;if(!e||!t)return null;try{return(0,a.eI)(e,t)}catch{return null}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,9498],()=>r(26238));module.exports=a})();