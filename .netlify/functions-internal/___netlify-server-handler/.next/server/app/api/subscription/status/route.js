"use strict";(()=>{var e={};e.id=8494,e.ids=[8494],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},17665:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>w,patchFetch:()=>b,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>z,staticGenerationAsyncStorage:()=>y});var r={};n.r(r),n.d(r,{GET:()=>p,dynamic:()=>l});var i=n(49303),s=n(88716),a=n(60670),u=n(87070),c=n(75571),o=n(90455),d=n(86287);let l="force-dynamic";async function p(e){try{let e=await (0,c.getServerSession)(o.L);if(!e?.user)return u.NextResponse.json({isPremium:!1,canAccess:!1,stats:null});let t=e.user.id,n=await (0,d.rz)(t),r=await (0,d.cv)(t),i=await (0,d.F3)(t);return u.NextResponse.json({isPremium:n,canAccess:n&&r,stats:i})}catch(e){return console.error("Subscription status API error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let f=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/subscription/status/route",pathname:"/api/subscription/status",filename:"route",bundlePath:"app/api/subscription/status/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/subscription/status/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:y,serverHooks:z}=f,w="/api/subscription/status/route";function b(){return(0,a.patchFetch)({serverHooks:z,staticGenerationAsyncStorage:y})}},90455:(e,t,n)=>{n.d(t,{L:()=>a});var r=n(77234),i=n(53797);let s=[];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&s.push((0,r.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.DEV_CREDENTIALS_PASSWORD&&s.push((0,i.Z)({name:"Dev Login",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){let t=e?.email?.toString()||"",n=e?.password?.toString()||"";return t&&n&&n===process.env.DEV_CREDENTIALS_PASSWORD?{id:t,email:t,name:t.split("@")[0]}:null}}));let a={providers:s,secret:process.env.NEXTAUTH_SECRET,session:{strategy:"jwt"},callbacks:{session:async({session:e})=>e}}},9487:(e,t,n)=>{n.d(t,{_:()=>s,s:()=>a});var r=n(53524);let i=()=>({user:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-user",...e}),count:async()=>0},quizRun:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-run",...e}),count:async()=>0,update:async()=>({}),updateMany:async()=>({})},quizAnswer:{findMany:async()=>[],create:async e=>({id:"mock-answer",...e}),createMany:async()=>({count:0})},subscription:{findUnique:async()=>null,findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-sub",...e}),update:async({data:e})=>({id:"mock-sub",...e}),upsert:async({create:e,update:t})=>({id:"mock-sub",...t||e}),delete:async()=>({})},manualDiscount:{findFirst:async()=>null,update:async({data:e})=>({id:"mock-discount",...e}),create:async({data:e})=>({id:"mock-discount",...e})},purchase:{findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-purchase",...e}),count:async()=>0},emailLog:{create:async({data:e})=>({id:"mock-email",status:e?.status||"sent",...e}),update:async({where:e,data:t})=>({id:e?.id||"mock-email",...t}),findMany:async()=>[]},newsletter:{create:async e=>({id:"mock-subscriber",...e}),count:async()=>0},$connect:async()=>{},$disconnect:async()=>{},$transaction:async e=>e(void 0)}),s=globalThis.prisma??function(){if(!process.env.DATABASE_URL)return console.warn("No DATABASE_URL found - using mock client"),i();try{return new r.PrismaClient({log:["error"],datasources:{db:{url:process.env.DATABASE_URL}}})}catch(e){return console.error("Failed to create Prisma client:",e),i()}}();async function a(e,t){if(!s)return console.warn("Database not available - returning fallback value"),t;try{return await e()}catch(e){return console.error("Database operation failed:",e),t}}},86287:(e,t,n)=>{n.d(t,{C2:()=>U,EO:()=>w,F3:()=>z,F6:()=>d,FR:()=>l,HA:()=>_,XW:()=>s,Xt:()=>f,Z1:()=>g,cv:()=>o,gL:()=>m,kk:()=>v,m2:()=>h,qZ:()=>p,rz:()=>c,uF:()=>u,vQ:()=>y,vS:()=>a});var r=n(9487);let i={premiumArticlesLimit:3,freeQuizzesLimit:2,freeQuizValueCap:50,articleDiscountPercent:30,quizDiscountPercent:20,discountedQuizzesLimit:3};async function s(e,t,n,s){let a=new Date,u=new Date(a.getTime()+2592e6);return await r._.subscription.create({data:{userId:e,plan:"premium",status:"active",stripeCustomerId:t,stripeSubscriptionId:n,stripePriceId:s,startDate:a,endDate:u,currentPeriodStart:a,currentPeriodEnd:u,premiumArticlesUsed:0,premiumArticlesLimit:i.premiumArticlesLimit,freeQuizzesUsed:0,freeQuizzesLimit:i.freeQuizzesLimit,freeQuizValueCap:i.freeQuizValueCap,discountedQuizzesUsed:0,discountedQuizzesLimit:i.discountedQuizzesLimit,lastCycleReset:a}})}async function a(e){var t,n;let i=await r._.subscription.findUnique({where:{userId:e}});return i&&"active"===i.status?(t=new Date,n=i.lastCycleReset,t.getUTCFullYear()!==n.getUTCFullYear()||t.getUTCMonth()!==n.getUTCMonth())?await b(i.id):i:null}async function u(e){return await r._.subscription.findUnique({where:{stripeSubscriptionId:e}})}async function c(e){let t=await a(e);return!!t&&t.endDate>new Date&&"active"===t.status}async function o(e){let t=await a(e);return!!t&&t.premiumArticlesUsed<t.premiumArticlesLimit}async function d(e){let t=await a(e);return!!(t&&await o(e))&&(await r._.subscription.update({where:{id:t.id},data:{premiumArticlesUsed:{increment:1}}}),!0)}async function l(e,t){return await a(e)?await o(e)?0:Math.round(t*(1-i.articleDiscountPercent/100)*100)/100:null}async function p(e,t){let n=await a(e);return!!n&&n.freeQuizzesUsed<n.freeQuizzesLimit&&t<=n.freeQuizValueCap}async function f(e,t){let n=await a(e);return n?await p(e,t)?0:n.discountedQuizzesUsed<n.discountedQuizzesLimit?Math.round(t*(1-i.quizDiscountPercent/100)*100)/100:t:null}async function m(e){let t=await a(e);return!!t&&t.discountedQuizzesUsed<t.discountedQuizzesLimit&&(await r._.subscription.update({where:{id:t.id},data:{discountedQuizzesUsed:{increment:1}}}),!0)}async function y(e){let t=await a(e);return!!t&&t.freeQuizzesUsed<t.freeQuizzesLimit&&(await r._.subscription.update({where:{id:t.id},data:{freeQuizzesUsed:{increment:1}}}),!0)}async function z(e){let t=await a(e);return t?{plan:t.plan,status:t.status,premiumArticlesUsed:t.premiumArticlesUsed,premiumArticlesRemaining:t.premiumArticlesLimit-t.premiumArticlesUsed,freeQuizzesUsed:t.freeQuizzesUsed,freeQuizzesRemaining:t.freeQuizzesLimit-t.freeQuizzesUsed,freeQuizValueCap:t.freeQuizValueCap,discountedQuizzesUsed:t.discountedQuizzesUsed,discountedQuizzesRemaining:t.discountedQuizzesLimit-t.discountedQuizzesUsed,endDate:t.endDate,currentPeriodEnd:t.currentPeriodEnd,daysRemaining:Math.ceil((t.endDate.getTime()-Date.now())/864e5),cancelAtPeriodEnd:t.cancelAtPeriodEnd}:null}async function w(e,t=!0){let n=await a(e);return!!n&&(await r._.subscription.update({where:{id:n.id},data:{cancelAtPeriodEnd:t,canceledAt:new Date,...t?{}:{status:"cancelled",endDate:new Date}}}),!0)}async function b(e){let t=new Date,n=new Date(t.getTime()+2592e6);return await r._.subscription.update({where:{id:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:t,currentPeriodStart:t,currentPeriodEnd:n}})}async function v(e,t){let n=await u(e);return n?await r._.subscription.update({where:{id:n.id},data:t}):null}async function g(e,t){return!1}async function _(e,t){return!0}async function U(e,t){return!0}async function h(e){return!!await a(e)&&(await r._.subscription.update({where:{userId:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:new Date}}),!0)}},69955:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},75571:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.default}});var i=n(69955);Object.keys(i).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e))&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))});var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(void 0);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&({}).hasOwnProperty.call(e,s)){var u=i?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(r,s,u):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(n(45609));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}Object.keys(s).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e))&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))})}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[8948,5972,2830],()=>n(17665));module.exports=r})();