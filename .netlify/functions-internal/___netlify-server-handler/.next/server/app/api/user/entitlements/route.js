"use strict";(()=>{var e={};e.id=1092,e.ids=[1092],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},96657:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>z,routeModule:()=>y,serverHooks:()=>b,staticGenerationAsyncStorage:()=>w});var i={};n.r(i),n.d(i,{GET:()=>f});var r=n(49303),s=n(88716),a=n(60670),u=n(87070),c=n(75571),o=n(90455),d=n(86287),l=n(9487);async function p(e,t=!1){if(await (0,d.vS)(e))return!0;if(t){let t=new Date;return t.setHours(0,0,0,0),await l._.aIConversation.count({where:{userId:e,mode:"general",createdAt:{gte:t}}})<5}return!0}async function m(e){let[t,n,i]=await Promise.all([(0,d.rz)(e),(0,d.F3)(e),p(e,!1)]);return{isPremium:t,subscription:n,aiAccess:{unlimited:t,canUse:i},features:{premiumArticles:t,freeQuizzes:!!n&&n.freeQuizzesRemaining>0,discountedQuizzes:!!n&&n.discountedQuizzesRemaining>0,unlimitedAI:t}}}async function f(e){try{let e=await (0,c.getServerSession)(o.L);if(!e?.user)return u.NextResponse.json({isPremium:!1,subscription:null,aiAccess:{unlimited:!1,canUse:!0},features:{premiumArticles:!1,freeQuizzes:!1,discountedQuizzes:!1,unlimitedAI:!1}},{status:200});let t=e.user.id,n=await m(t);return u.NextResponse.json(n)}catch(e){return console.error("Error fetching entitlements:",e),u.NextResponse.json({error:"Failed to fetch entitlements"},{status:500})}}let y=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/user/entitlements/route",pathname:"/api/user/entitlements",filename:"route",bundlePath:"app/api/user/entitlements/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/user/entitlements/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:z,staticGenerationAsyncStorage:w,serverHooks:b}=y,g="/api/user/entitlements/route";function v(){return(0,a.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:w})}},90455:(e,t,n)=>{n.d(t,{L:()=>a});var i=n(77234),r=n(53797);let s=[];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&s.push((0,i.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.DEV_CREDENTIALS_PASSWORD&&s.push((0,r.Z)({name:"Dev Login",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){let t=e?.email?.toString()||"",n=e?.password?.toString()||"";return t&&n&&n===process.env.DEV_CREDENTIALS_PASSWORD?{id:t,email:t,name:t.split("@")[0]}:null}}));let a={providers:s,secret:process.env.NEXTAUTH_SECRET,session:{strategy:"jwt"},callbacks:{session:async({session:e})=>e}}},9487:(e,t,n)=>{n.d(t,{_:()=>s,s:()=>a});var i=n(53524);let r=()=>({user:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-user",...e}),count:async()=>0},quizRun:{findMany:async()=>[],findUnique:async()=>null,create:async e=>({id:"mock-run",...e}),count:async()=>0,update:async()=>({}),updateMany:async()=>({})},quizAnswer:{findMany:async()=>[],create:async e=>({id:"mock-answer",...e}),createMany:async()=>({count:0})},subscription:{findUnique:async()=>null,findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-sub",...e}),update:async({data:e})=>({id:"mock-sub",...e}),upsert:async({create:e,update:t})=>({id:"mock-sub",...t||e}),delete:async()=>({})},manualDiscount:{findFirst:async()=>null,update:async({data:e})=>({id:"mock-discount",...e}),create:async({data:e})=>({id:"mock-discount",...e})},purchase:{findFirst:async()=>null,findMany:async()=>[],create:async({data:e})=>({id:"mock-purchase",...e}),count:async()=>0},emailLog:{create:async({data:e})=>({id:"mock-email",status:e?.status||"sent",...e}),update:async({where:e,data:t})=>({id:e?.id||"mock-email",...t}),findMany:async()=>[]},newsletter:{create:async e=>({id:"mock-subscriber",...e}),count:async()=>0},$connect:async()=>{},$disconnect:async()=>{},$transaction:async e=>e(void 0)}),s=globalThis.prisma??function(){if(!process.env.DATABASE_URL)return console.warn("No DATABASE_URL found - using mock client"),r();try{return new i.PrismaClient({log:["error"],datasources:{db:{url:process.env.DATABASE_URL}}})}catch(e){return console.error("Failed to create Prisma client:",e),r()}}();async function a(e,t){if(!s)return console.warn("Database not available - returning fallback value"),t;try{return await e()}catch(e){return console.error("Database operation failed:",e),t}}},86287:(e,t,n)=>{n.d(t,{C2:()=>A,EO:()=>w,F3:()=>z,F6:()=>d,FR:()=>l,HA:()=>Q,XW:()=>s,Xt:()=>m,Z1:()=>v,cv:()=>o,gL:()=>f,kk:()=>g,m2:()=>h,qZ:()=>p,rz:()=>c,uF:()=>u,vQ:()=>y,vS:()=>a});var i=n(9487);let r={premiumArticlesLimit:3,freeQuizzesLimit:2,freeQuizValueCap:50,articleDiscountPercent:30,quizDiscountPercent:20,discountedQuizzesLimit:3};async function s(e,t,n,s){let a=new Date,u=new Date(a.getTime()+2592e6);return await i._.subscription.create({data:{userId:e,plan:"premium",status:"active",stripeCustomerId:t,stripeSubscriptionId:n,stripePriceId:s,startDate:a,endDate:u,currentPeriodStart:a,currentPeriodEnd:u,premiumArticlesUsed:0,premiumArticlesLimit:r.premiumArticlesLimit,freeQuizzesUsed:0,freeQuizzesLimit:r.freeQuizzesLimit,freeQuizValueCap:r.freeQuizValueCap,discountedQuizzesUsed:0,discountedQuizzesLimit:r.discountedQuizzesLimit,lastCycleReset:a}})}async function a(e){var t,n;let r=await i._.subscription.findUnique({where:{userId:e}});return r&&"active"===r.status?(t=new Date,n=r.lastCycleReset,t.getUTCFullYear()!==n.getUTCFullYear()||t.getUTCMonth()!==n.getUTCMonth())?await b(r.id):r:null}async function u(e){return await i._.subscription.findUnique({where:{stripeSubscriptionId:e}})}async function c(e){let t=await a(e);return!!t&&t.endDate>new Date&&"active"===t.status}async function o(e){let t=await a(e);return!!t&&t.premiumArticlesUsed<t.premiumArticlesLimit}async function d(e){let t=await a(e);return!!(t&&await o(e))&&(await i._.subscription.update({where:{id:t.id},data:{premiumArticlesUsed:{increment:1}}}),!0)}async function l(e,t){return await a(e)?await o(e)?0:Math.round(t*(1-r.articleDiscountPercent/100)*100)/100:null}async function p(e,t){let n=await a(e);return!!n&&n.freeQuizzesUsed<n.freeQuizzesLimit&&t<=n.freeQuizValueCap}async function m(e,t){let n=await a(e);return n?await p(e,t)?0:n.discountedQuizzesUsed<n.discountedQuizzesLimit?Math.round(t*(1-r.quizDiscountPercent/100)*100)/100:t:null}async function f(e){let t=await a(e);return!!t&&t.discountedQuizzesUsed<t.discountedQuizzesLimit&&(await i._.subscription.update({where:{id:t.id},data:{discountedQuizzesUsed:{increment:1}}}),!0)}async function y(e){let t=await a(e);return!!t&&t.freeQuizzesUsed<t.freeQuizzesLimit&&(await i._.subscription.update({where:{id:t.id},data:{freeQuizzesUsed:{increment:1}}}),!0)}async function z(e){let t=await a(e);return t?{plan:t.plan,status:t.status,premiumArticlesUsed:t.premiumArticlesUsed,premiumArticlesRemaining:t.premiumArticlesLimit-t.premiumArticlesUsed,freeQuizzesUsed:t.freeQuizzesUsed,freeQuizzesRemaining:t.freeQuizzesLimit-t.freeQuizzesUsed,freeQuizValueCap:t.freeQuizValueCap,discountedQuizzesUsed:t.discountedQuizzesUsed,discountedQuizzesRemaining:t.discountedQuizzesLimit-t.discountedQuizzesUsed,endDate:t.endDate,currentPeriodEnd:t.currentPeriodEnd,daysRemaining:Math.ceil((t.endDate.getTime()-Date.now())/864e5),cancelAtPeriodEnd:t.cancelAtPeriodEnd}:null}async function w(e,t=!0){let n=await a(e);return!!n&&(await i._.subscription.update({where:{id:n.id},data:{cancelAtPeriodEnd:t,canceledAt:new Date,...t?{}:{status:"cancelled",endDate:new Date}}}),!0)}async function b(e){let t=new Date,n=new Date(t.getTime()+2592e6);return await i._.subscription.update({where:{id:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:t,currentPeriodStart:t,currentPeriodEnd:n}})}async function g(e,t){let n=await u(e);return n?await i._.subscription.update({where:{id:n.id},data:t}):null}async function v(e,t){return!1}async function Q(e,t){return!0}async function A(e,t){return!0}async function h(e){return!!await a(e)&&(await i._.subscription.update({where:{userId:e},data:{premiumArticlesUsed:0,freeQuizzesUsed:0,discountedQuizzesUsed:0,lastCycleReset:new Date}}),!0)}},69955:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},75571:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.default}});var r=n(69955);Object.keys(r).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e))&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))});var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(void 0);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&({}).hasOwnProperty.call(e,s)){var u=r?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(45609));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}Object.keys(s).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e))&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))})}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),i=t.X(0,[8948,5972,2830],()=>n(96657));module.exports=i})();