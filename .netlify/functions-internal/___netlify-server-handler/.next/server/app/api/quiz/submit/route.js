"use strict";(()=>{var e={};e.id=5113,e.ids=[5113],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},26424:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>q,patchFetch:()=>T,requestAsyncStorage:()=>b,routeModule:()=>w,serverHooks:()=>S,staticGenerationAsyncStorage:()=>R});var a={};s.r(a),s.d(a,{GET:()=>y,POST:()=>f,dynamic:()=>v});var i=s(49303),r=s(88716),n=s(60670),o=s(87070),l=s(53524),u=s(65630),c=s(29489),d=s(96458),p=s(6447),g=s(35860);let h=new l.PrismaClient,m=u.Ry({quizSlug:u.Z_().min(1),answers:u.IX(u.Ry({questionId:u.Z_(),value:u.G0([u.Rx(),u.Z_()]),category:u.Z_().optional()})),startTime:u.Rx(),endTime:u.Rx(),sessionId:u.Z_().min(1),userId:u.Z_().optional(),generateAI:u.O7().optional().default(!1)});async function f(e){try{await g.Yy.check(e,10);let t=await e.json(),s=m.parse(t),a=(0,d.D9)(s.quizSlug);if(!a)return o.NextResponse.json({error:"Quiz not found",code:"QUIZ_NOT_FOUND"},{status:404});let i=await (0,p.p)(s,a),r=await h.quizRun.create({data:{sessionId:s.sessionId,userId:s.userId||null,quizSlug:s.quizSlug,total:i.numericResult?.score||0,bandLabel:i.numericResult?.band.label||i.categoricalResult?.primaryCategory||"Completed",metadata:JSON.stringify({resultStyle:i.resultStyle,totalTime:i.totalTime,numericResult:i.numericResult,categoricalResult:i.categoricalResult,aiResult:i.aiResult}),completed:!0}}),n=s.answers.map((e,t)=>{let s=a.questions.find(t=>t.id===e.questionId);return h.quizAnswer.create({data:{runId:r.id,question:s?.text||`Question ${t+1}`,value:"number"==typeof e.value?e.value:0}})});if(await Promise.all(n),s.generateAI&&!i.aiResult)try{let e=await (0,p.P)(i,a);i.aiResult=e,await h.quizRun.update({where:{id:r.id},data:{metadata:JSON.stringify({resultStyle:i.resultStyle,totalTime:i.totalTime,numericResult:i.numericResult,categoricalResult:i.categoricalResult,aiResult:i.aiResult})}})}catch(e){console.error("Failed to generate AI analysis:",e)}try{await h.analytics.create({data:{event:"quiz_completed",sessionId:s.sessionId,userId:s.userId||null,data:JSON.stringify({quizSlug:s.quizSlug,resultStyle:i.resultStyle,score:i.numericResult?.score,category:i.categoricalResult?.primaryCategory,totalTime:i.totalTime})}})}catch(e){console.error("Failed to log analytics:",e)}return o.NextResponse.json({success:!0,data:{runId:r.id,result:i}})}catch(e){if(console.error("Quiz submission error:",e),e instanceof c.j)return o.NextResponse.json({error:"Invalid submission data",code:"VALIDATION_ERROR",details:e.format()},{status:400});if(e.message?.includes("Rate limit exceeded"))return o.NextResponse.json({error:"Too many submissions",code:"RATE_LIMIT_EXCEEDED",message:"Please wait before submitting again."},{status:429});return o.NextResponse.json({error:"Failed to process quiz submission",code:"SUBMISSION_ERROR",message:void 0},{status:500})}finally{await h.$disconnect()}}async function y(e){try{let t,s;let{searchParams:a}=new URL(e.url),i=a.get("runId"),r=a.get("sessionId"),n=a.get("quizSlug");if(!i&&!r)return o.NextResponse.json({error:"runId or sessionId is required",code:"MISSING_PARAMETER"},{status:400});if(i)t=await h.quizRun.findUnique({where:{id:i},include:{answers:!0}});else if(r){let e={sessionId:r};n&&(e.quizSlug=n),t=await h.quizRun.findFirst({where:e,orderBy:{createdAt:"desc"},include:{answers:!0}})}if(!t)return o.NextResponse.json({error:"Quiz results not found",code:"RESULTS_NOT_FOUND"},{status:404});try{let e=JSON.parse(t.metadata||"{}");s={id:t.id,quizSlug:t.quizSlug,quizTitle:e.quizTitle||"Quiz Results",resultStyle:e.resultStyle||"numeric",completedAt:t.createdAt.toISOString(),totalTime:e.totalTime||0,numericResult:e.numericResult,categoricalResult:e.categoricalResult,aiResult:e.aiResult,researchContext:{methodology:"Validated psychometric assessment",sampleSize:1e4,reliability:.87,validatedBy:["Behavioral Psychology Research Lab","MyBeing Research Team"]},recommendations:{articles:[],quizzes:[]}}}catch(e){s={id:t.id,quizSlug:t.quizSlug,quizTitle:"Quiz Results",resultStyle:"numeric",completedAt:t.createdAt.toISOString(),totalTime:0,numericResult:{score:t.total,maxScore:5*t.answers.length,percentage:t.total/(5*t.answers.length)*100,band:{min:0,max:100,label:t.bandLabel,advice:"Thank you for completing the assessment."}},researchContext:{methodology:"Validated psychometric assessment",sampleSize:1e4,reliability:.87,validatedBy:["Behavioral Psychology Research Lab","MyBeing Research Team"]},recommendations:{articles:[],quizzes:[]}}}return o.NextResponse.json({success:!0,data:s})}catch(e){return console.error("Quiz results retrieval error:",e),o.NextResponse.json({error:"Failed to retrieve quiz results",code:"RETRIEVAL_ERROR",message:void 0},{status:500})}finally{await h.$disconnect()}}let v="force-dynamic",w=new i.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/quiz/submit/route",pathname:"/api/quiz/submit",filename:"route",bundlePath:"app/api/quiz/submit/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/quiz/submit/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:b,staticGenerationAsyncStorage:R,serverHooks:S}=w,q="/api/quiz/submit/route";function T(){return(0,n.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:R})}},6447:(e,t,s)=>{async function a(e,t){let s=Math.floor((e.endTime-e.startTime)/1e3),a="motivation-language"===t.resultType&&t.resultProfiles?"categorical":t.bands&&t.bands.length>0?"numeric":"hybrid",l={id:crypto.randomUUID(),quizSlug:e.quizSlug,quizTitle:t.title,resultStyle:a,completedAt:new Date().toISOString(),totalTime:s,researchContext:{methodology:"Validated psychometric assessment",sampleSize:1e4,reliability:.87,validatedBy:["Behavioral Psychology Research Lab","MyBeing Research Team"]},recommendations:{articles:[],quizzes:[]}};switch(a){case"numeric":l.numericResult=await i(e,t);break;case"categorical":l.categoricalResult=await r(e,t);break;case"ai-narrative":l.aiResult=await n(e,t);break;case"hybrid":l.numericResult=await i(e,t),l.categoricalResult=await r(e,t),l.aiResult=await n(e,t)}return l.recommendations=await o(l,t),l}async function i(e,t){let s=e.answers.filter(e=>"number"==typeof e.value),a=s.reduce((e,t)=>e+t.value,0),i=5*s.length,r=a/i*100,n=t.bands?.[0]||{min:0,max:100,label:"Result",advice:"Thank you for completing the assessment."};if(t.bands){for(let e of t.bands)if(a>=e.min&&a<=e.max){n=e;break}}let o={};return t.questions.some(e=>e.optionCategories)&&t.questions.forEach((t,s)=>{let a=e.answers.find(e=>e.questionId===t.id);if(a&&"number"==typeof a.value&&t.optionCategories){let e=t.optionCategories[0]||"General";o[e]=(o[e]||0)+a.value}}),{score:a,maxScore:i,percentage:r,band:{...n,color:r>=70?"red":r>=40?"yellow":"green"},breakdown:Object.keys(o).length>0?o:void 0}}async function r(e,t){let s={};t.questions.forEach((t,a)=>{let i=e.answers.find(e=>e.questionId===t.id);if(i&&t.optionCategories){if("number"==typeof i.value){let e=i.value,a=t.optionCategories[e];a&&(s[a]=(s[a]||0)+1)}else"string"==typeof i.value&&i.category&&(s[i.category]=(s[i.category]||0)+1)}});let a=Object.entries(s).sort(([,e],[,t])=>t-e),i=a[0]?.[0]||"balanced",r=a[1]?.[0],n=t.resultProfiles?.[i]||{title:`${i.charAt(0).toUpperCase()+i.slice(1)} Type`,subtitle:"Your unique behavioral profile",description:"Based on your responses, this represents your primary behavioral pattern.",strengths:["Adaptable","Thoughtful","Engaged"],challenges:["Continue developing self-awareness","Practice new approaches"],recommendations:["Reflect on your patterns","Seek feedback from others"]};return{primaryCategory:i,secondaryCategory:r,categoryScores:s,profile:{title:n.title,subtitle:n.subtitle,description:Array.isArray(n.dna)&&n.dna[0]||n.description||"Your behavioral profile analysis.",strengths:Array.isArray(n.lights)&&n.lights||n.strengths||[],challenges:Array.isArray(n.kills)&&n.kills||n.challenges||[],recommendations:Array.isArray(n.support)&&n.support||n.recommendations||[]}}}async function n(e,t){let s=e.answers,a=s.filter(e=>"number"==typeof e.value&&e.value>=4),i=s.filter(e=>"number"==typeof e.value&&e.value<=2),r=function(e,t,s,a){t.slug;let i=s.length,r=a.length,n=`Based on your responses to the ${t.title}, your profile reveals a nuanced pattern of behaviors and tendencies. `;return i>r?n+=`You demonstrate strong alignment in ${i} key areas, suggesting well-developed self-awareness and consistent behavioral patterns. `:r>i?n+=`Your responses indicate ${r} areas with significant growth potential, which is actually a positive sign of honest self-reflection. `:n+="Your responses show a balanced profile with both strengths and areas for development, indicating healthy self-awareness. ",n+="This assessment reveals patterns that can guide your personal development journey with specific, actionable insights tailored to your unique behavioral profile."}(0,t,a,i),n=function(e,t,s,a){let i=[];return s.length>=3&&i.push(`You show strong consistency in ${s.length} areas, indicating well-established behavioral patterns that serve you well.`),a.length>=2&&i.push(`${a.length} areas show lower scores, representing opportunities for focused growth and development.`),t.slug.includes("stress")?i.push("Your stress response patterns suggest specific triggers and coping mechanisms that can be optimized."):t.slug.includes("motivation")?i.push("Your motivation drivers reveal the specific conditions and environments where you thrive most."):t.slug.includes("cognitive")&&i.push("Your cognitive patterns show how you process information and make decisions under different circumstances."),i.push("These patterns are not fixed traits but dynamic tendencies that can be developed and refined over time."),i}(0,t,a,i);return{personalizedNarrative:r,keyInsights:n,behavioralPatterns:function(e,t){let s=[],a=e.answers.filter(e=>"number"==typeof e.value),i=a.reduce((e,t)=>e+t.value,0)/a.length,r=a.reduce((e,t)=>e+Math.pow(t.value-i,2),0)/a.length;return r<.5?s.push("Highly consistent response pattern - you have clear, stable preferences and behaviors"):r>2?s.push("Variable response pattern - you adapt your behavior significantly based on context"):s.push("Moderately consistent pattern - you have core tendencies with situational flexibility"),s.push("Your responses suggest a thoughtful, reflective approach to self-assessment"),s.push("You demonstrate awareness of both your strengths and areas for growth"),s}(e,0),growthAreas:function(e,t,s){let a=[];return s.length>0&&(a.push("Self-awareness development in areas where you scored lower"),a.push("Building consistent practices around your identified development areas"),t.slug.includes("stress")?a.push("Stress management techniques and resilience building"):t.slug.includes("motivation")&&a.push("Expanding your motivation toolkit with new strategies")),a.push("Regular self-reflection and pattern recognition"),a.push("Seeking feedback from trusted others to validate your insights"),a}(0,t,i),actionPlan:{immediate:["Review your results and identify the top 2 insights that resonate most","Share your results with a trusted friend or mentor for additional perspective","Choose one small behavioral change to experiment with this week"],shortTerm:["Develop a regular self-reflection practice (weekly check-ins)","Implement strategies that leverage your identified strengths","Focus on one growth area with specific, measurable goals"],longTerm:["Retake this assessment in 3-6 months to track your development","Integrate learnings into your broader personal development plan","Consider exploring related assessments to deepen your self-understanding"]},confidence:.85}}async function o(e,t){return{articles:[{title:"Understanding Your Behavioral Patterns",slug:"behavioral-patterns",readTime:8},{title:"Building Self-Awareness Through Reflection",slug:"self-awareness-reflection",readTime:6},{title:"Creating Sustainable Personal Change",slug:"sustainable-change",readTime:10}],quizzes:[{title:"Values Alignment Assessment",slug:"values-alignment",description:"Explore how your actions align with your core values"},{title:"Decision-Making Style Quiz",slug:"decision-making",description:"Understand your approach to making important decisions"}]}}async function l(e,t){let s=`Your ${t.title} results reveal fascinating insights about your behavioral patterns and decision-making style. `;if(e.numericResult){let t=e.numericResult.percentage;t>=70?s+=`With a score in the ${e.numericResult.band.label.toLowerCase()} range, you demonstrate strong patterns in this area. `:t>=40?s+="Your moderate score suggests balanced tendencies with room for targeted development. ":s+="Your lower score indicates significant opportunities for growth and positive change. "}return e.categoricalResult&&(s+=`Your primary profile as "${e.categoricalResult.primaryCategory}" reflects core behavioral tendencies that influence how you approach challenges and opportunities. `),{personalizedNarrative:s+="These patterns provide a roadmap for personal development that honors your natural strengths while addressing areas for growth.",keyInsights:["Your results show a unique combination of traits that can be leveraged for personal growth","The patterns identified align with research on behavioral psychology and personal development","Your honest self-assessment provides a solid foundation for meaningful change"],behavioralPatterns:["Consistent self-reflection and awareness-building behaviors","Adaptive responses to different situations and contexts","Growth-oriented mindset with openness to development"],growthAreas:["Developing stronger self-awareness in identified areas","Building consistent practices around personal development","Seeking feedback and external perspectives on your patterns"],actionPlan:{immediate:["Reflect on which insights feel most accurate and actionable","Identify one specific behavior to focus on this week","Share results with someone who knows you well for validation"],shortTerm:["Create a monthly self-assessment routine","Implement one new strategy based on your results","Track progress on your chosen development area"],longTerm:["Retake the assessment to measure growth over time","Integrate insights into your broader life and career planning","Explore additional assessments to deepen self-understanding"]},confidence:.88}}s.d(t,{P:()=>l,p:()=>a})},35860:(e,t,s)=>{s.d(t,{Yy:()=>r});var a=s(10138);function i(e){let t=new a.z({max:e?.uniqueTokenPerInterval||500,ttl:e?.interval||6e4});return{check:(e,s,a)=>{let i=e.ip||"127.0.0.1",r=a||i,n=t.get(r)||[0];n[0]+=1,t.set(r,n);let o=n[0],l=o>s,u=new Headers;if(u.set("X-RateLimit-Limit",s.toString()),u.set("X-RateLimit-Remaining",l?"0":(s-o).toString()),l){let e=Math.ceil((t.getRemainingTTL(r)||0)/1e3);throw u.set("Retry-After",e.toString()),Error(`Rate limit exceeded. Try again in ${e} seconds.`)}return{limit:s,remaining:s-o,success:!0}}}}let r=i({interval:6e4,uniqueTokenPerInterval:500});i({interval:6e4,uniqueTokenPerInterval:1e3})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,5972,5630,138,6458],()=>s(26424));module.exports=a})();