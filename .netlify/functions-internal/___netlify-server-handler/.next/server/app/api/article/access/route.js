"use strict";(()=>{var e={};e.id=2679,e.ids=[2679],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},67766:(e,i,t)=>{t.r(i),t.d(i,{originalPathname:()=>p,patchFetch:()=>h,requestAsyncStorage:()=>z,routeModule:()=>o,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var r={};t.r(r),t.d(r,{GET:()=>d,dynamic:()=>l});var s=t(49303),u=t(88716),n=t(60670),c=t(87070),a=t(81211);let l="force-dynamic";async function d(e){try{let{searchParams:i}=new URL(e.url),t=i.get("slug"),r=i.get("email")||void 0;if(!t)return c.NextResponse.json({error:"Missing slug"},{status:400});let s=(0,a.Hh)(r,t);if(!s.exists)return c.NextResponse.json({error:"Article not found"},{status:404});return c.NextResponse.json(s)}catch(e){return console.error("Article access API error:",e),c.NextResponse.json({error:"Internal server error"},{status:500})}}let o=new s.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/article/access/route",pathname:"/api/article/access",filename:"route",bundlePath:"app/api/article/access/route"},resolvedPagePath:"/Users/niharikasai/mybeing/app/api/article/access/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:z,staticGenerationAsyncStorage:f,serverHooks:m}=o,p="/api/article/access/route";function h(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},81211:(e,i,t)=>{t.d(i,{Hh:()=>o,_v:()=>z});var r=t(4745),s=t(86287);let u=[],n=[];function c(e,i){return!!e&&u.some(t=>t.email===e&&t.slug===i)}function a(e,i,t){let r={id:Math.random().toString(36).slice(2,10),email:e,slug:i,pricePaid:t,purchasedAt:new Date};return u.push(r),r}function l(e,i){return n.some(t=>t.email===e&&t.slug===i)}function d(e,i){if(l(e,i))return!0;let t=(0,r.Wg)(i);return!!t&&(!t.isPremium||!!(0,s.cv)(e)&&!!(0,s.F6)(e)&&(n.push({email:e,slug:i,unlockedAt:new Date}),!0))}function o(e,i){let t=(0,r.Wg)(i);if(!t)return{exists:!1};let u="number"==typeof t.price?t.price:0;if(!(t.isPremium&&u>0))return{exists:!0,hasAccess:!0,isPaid:!1,basePrice:0,finalPrice:0,isSubscriber:!1,purchased:!1};let n=e||void 0,a=!!n&&c(n,i),o=!!n&&(0,s.rz)(n);if(a)return{exists:!0,hasAccess:!0,isPaid:!0,basePrice:u,finalPrice:0,isSubscriber:o,purchased:!0};if(n&&o){if(l(n,i))return{exists:!0,hasAccess:!0,isPaid:!0,basePrice:u,finalPrice:0,isSubscriber:o,purchased:!1};let e=(0,s.FR)(n,u);if(0===e)return d(n,i),{exists:!0,hasAccess:!0,isPaid:!0,basePrice:u,finalPrice:0,isSubscriber:o,purchased:!1};if(null!==e)return{exists:!0,hasAccess:!1,isPaid:!0,basePrice:u,finalPrice:e,isSubscriber:o,purchased:!1}}return{exists:!0,hasAccess:!1,isPaid:!0,basePrice:u,finalPrice:u,isSubscriber:o,purchased:!1}}function z(e,i){let t=(0,r.Wg)(i);if(!t)return{ok:!1,error:"Article not found"};let u="number"==typeof t.price?t.price:0,n=!!t.isPremium&&u>0;if(c(e,i))return{ok:!0,purchase:a(e,i,0)};let l=(0,s.FR)(e,u),o=n?u:0;return(null!==l&&(o=l),n&&0===o)?(d(e,i),{ok:!0,purchase:a(e,i,0)}):n&&0!==o?{ok:!0,purchase:a(e,i,o)}:{ok:!0,purchase:a(e,i,0)}}},86287:(e,i,t)=>{t.d(i,{C2:()=>U,EO:()=>x,ER:()=>L,F3:()=>g,F6:()=>f,FR:()=>m,HA:()=>P,XW:()=>l,Xt:()=>h,Z1:()=>D,cv:()=>z,gL:()=>Q,m2:()=>q,qZ:()=>p,rz:()=>o,vQ:()=>A});let r=[],s=[],u={price:32,premiumArticlesLimit:3,freeQuizzesLimit:2,freeQuizValueCap:50,articleDiscountPercent:30,quizFreeAccess:!1,quizDiscountPercent:20,discountedQuizzesLimit:3},n={quiz:50,article:50};function c(e){let i={id:v(),email:e,likedArticles:[],userDiscounts:[]};return s.push(i),i}function a(e){return s.find(i=>i.email===e)}function l(e){let i=a(e)||c(e),t={id:v(),userId:i.id,email:e,plan:"premium",status:"active",startDate:new Date,endDate:new Date(Date.now()+2592e6),price:u.price,premiumArticlesUsed:0,premiumArticlesLimit:u.premiumArticlesLimit,freeQuizzesUsed:0,freeQuizzesLimit:u.freeQuizzesLimit,freeQuizValueCap:u.freeQuizValueCap,articleDiscountPercent:u.articleDiscountPercent,quizFreeAccess:u.quizFreeAccess,quizDiscountPercent:u.quizDiscountPercent,discountedQuizzesUsed:0,discountedQuizzesLimit:u.discountedQuizzesLimit,manualDiscounts:[],lastCycleReset:new Date};return r.push(t),i.subscription=t,t}function d(e){let i=r.find(i=>i.email===e&&"active"===i.status);return i&&function(e){var i;let t=new Date;i=e.lastCycleReset,(t.getUTCFullYear()!==i.getUTCFullYear()||t.getUTCMonth()!==i.getUTCMonth())&&(e.premiumArticlesUsed=0,e.freeQuizzesUsed=0,e.discountedQuizzesUsed=0,e.lastCycleReset=t,e.endDate<t&&(e.endDate=new Date(t.getTime()+2592e6)))}(i),i}function o(e){let i=d(e);return!!i&&i.endDate>new Date}function z(e){let i=d(e);return!!i&&i.premiumArticlesUsed<i.premiumArticlesLimit}function f(e){let i=d(e);return!!(i&&z(e))&&(i.premiumArticlesUsed+=1,!0)}function m(e,i){let t=d(e);return t?z(e)?0:Math.round(i*(1-t.articleDiscountPercent/100)*100)/100:null}function p(e,i){let t=d(e);return!!t&&(!!t.quizFreeAccess||t.freeQuizzesUsed<t.freeQuizzesLimit&&i<=t.freeQuizValueCap)}function h(e,i){let t=d(e);return t?p(e,i)?0:t.discountedQuizzesUsed<t.discountedQuizzesLimit?Math.round(i*(1-t.quizDiscountPercent/100)*100)/100:i:null}function Q(e){let i=d(e);return!!i&&i.discountedQuizzesUsed<i.discountedQuizzesLimit&&(i.discountedQuizzesUsed+=1,!0)}function A(e){let i=d(e);return!!i&&(!!i.quizFreeAccess||i.freeQuizzesUsed<i.freeQuizzesLimit&&(i.freeQuizzesUsed+=1,!0))}function P(e,i){let t=a(e)||c(e);return!t.likedArticles.includes(i)&&(t.likedArticles.push(i),!0)}function U(e,i){let t=a(e);if(!t)return!1;let r=t.likedArticles.indexOf(i);return r>-1&&(t.likedArticles.splice(r,1),!0)}function D(e,i){let t=a(e);return!!t&&t.likedArticles.includes(i)}function g(e){let i=d(e);return i?{plan:i.plan,status:i.status,premiumArticlesUsed:i.premiumArticlesUsed,premiumArticlesRemaining:i.premiumArticlesLimit-i.premiumArticlesUsed,freeQuizzesUsed:i.freeQuizzesUsed,freeQuizzesRemaining:i.freeQuizzesLimit-i.freeQuizzesUsed,freeQuizValueCap:i.freeQuizValueCap,discountedQuizzesUsed:i.discountedQuizzesUsed,discountedQuizzesRemaining:i.discountedQuizzesLimit-i.discountedQuizzesUsed,endDate:i.endDate,daysRemaining:Math.ceil((i.endDate.getTime()-Date.now())/864e5)}:null}function x(e){let i=r.find(i=>i.email===e&&"active"===i.status);return!!i&&(i.status="cancelled",i.endDate=new Date,!0)}function q(e){let i=d(e);return!!i&&(i.premiumArticlesUsed=0,i.freeQuizzesUsed=0,i.discountedQuizzesUsed=0,i.lastCycleReset=new Date,!0)}function v(){return Math.random().toString(36).substr(2,9)}function L(e,i,t){let r=n[i],s=d(e);if(s){if("quiz"===i&&(s.quizFreeAccess||s.freeQuizzesUsed<s.freeQuizzesLimit&&r<=s.freeQuizValueCap))return 0;if("quiz"===i&&s.discountedQuizzesUsed<s.discountedQuizzesLimit)return Math.round(r*(1-s.quizDiscountPercent/100)*100)/100;if("article"===i&&z(e))return 0;if("article"===i)return Math.round(r*(1-s.articleDiscountPercent/100)*100)/100}let u=a(e);if(u){let e=u.userDiscounts.filter(e=>e.itemType===i&&(!e.itemId||e.itemId===t));if(e.length>0)return e.reduce((e,i)=>i.discountedPrice<e.discountedPrice?i:e).discountedPrice}return r}}};var i=require("../../../../webpack-runtime.js");i.C(e);var t=e=>i(i.s=e),r=i.X(0,[8948,5972,4745],()=>t(67766));module.exports=r})();