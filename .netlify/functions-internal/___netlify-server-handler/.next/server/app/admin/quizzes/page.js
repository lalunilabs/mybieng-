(()=>{var e={};e.id=4698,e.ids=[4698],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},76162:e=>{"use strict";e.exports=require("stream")},21764:e=>{"use strict";e.exports=require("util")},25486:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>r.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>c}),a(26705),a(3138),a(35044),a(15778),a(35866);var t=a(23191),l=a(88716),i=a(37922),r=a.n(i),n=a(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(s,d);let c=["",{children:["admin",{children:["quizzes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,26705)),"/Users/niharikasai/mybeing/app/admin/quizzes/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3138)),"/Users/niharikasai/mybeing/app/admin/layout.tsx"],metadata:{icon:[],apple:[],openGraph:[],twitter:[],manifest:"/manifest.json"}}]},{layout:[()=>Promise.resolve().then(a.bind(a,35044)),"/Users/niharikasai/mybeing/app/layout.tsx"],template:[()=>Promise.resolve().then(a.bind(a,15778)),"/Users/niharikasai/mybeing/app/template.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[],apple:[],openGraph:[],twitter:[],manifest:"/manifest.json"}}],o=["/Users/niharikasai/mybeing/app/admin/quizzes/page.tsx"],m="/admin/quizzes/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/quizzes/page",pathname:"/admin/quizzes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},47062:(e,s,a)=>{Promise.resolve().then(a.bind(a,7460)),Promise.resolve().then(a.bind(a,57311))},7460:(e,s,a)=>{"use strict";a.d(s,{default:()=>r});var t=a(10326),l=a(17577);function i({value:e,onChange:s,onSave:a,onDelete:i,onUploadImage:r,onUploadQuestionImage:n,onGenerateMeta:d,onValidateMeta:c}){let[o,m]=(0,l.useState)("overview"),[x,u]=(0,l.useState)(e||{}),[h,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),[j,v]=(0,l.useState)(""),[y,f]=(0,l.useState)(""),[N,w]=(0,l.useState)(null),[k,C]=(0,l.useState)("all"),q=e=>{let a={...x,...e};u(a),s(a)},S=async()=>{b(!0),f(""),v("");try{await a(x),v("Saved.")}catch(e){f(e?.message||"Save failed")}finally{b(!1)}},z=async e=>{if(x?.slug)try{let s=await fetch(`/api/admin/research/quiz/${encodeURIComponent(x.slug)}/export?format=${e}&timeRange=${k}`);if(!s.ok)return;let a=await s.blob(),t=URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download=`${x.slug}-research-${new Date().toISOString().split("T")[0]}.${e}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t)}catch{}},A=async()=>{if(x?.slug)try{let e=await fetch(`/api/admin/research/quiz/${encodeURIComponent(x.slug)}/report?timeRange=${k}`);if(!e.ok)return;let s=await e.blob(),a=URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download=`${x.slug}-research-report-${new Date().toISOString().split("T")[0]}.md`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}catch{}},U=(e,s)=>{let a=Array.isArray(x.questions)?[...x.questions]:[];a[e]=s,q({questions:a})},M=e=>{let s=[...x.questions||[]];s.splice(e,1),q({questions:s})},D=(e,s)=>{let a=[...x.questions||[]],t=e+s;if(t<0||t>=a.length)return;let l=a[e];a[e]=a[t],a[t]=l,q({questions:a})},P=(e,s)=>{let a=[...x.bands||[]];a[e]=s,q({bands:a})},L=e=>{let s=[...x.bands||[]];s.splice(e,1),q({bands:s})},R=(e,s)=>{let a=[...x.bands||[]],t=e+s;if(t<0||t>=a.length)return;let l=a[e];a[e]=a[t],a[t]=l,q({bands:a})};return(0,t.jsxs)("div",{children:[(y||j)&&(0,t.jsxs)("div",{className:"mb-3 space-y-2",children:[y&&t.jsx("div",{className:"text-sm text-red-600 whitespace-pre-wrap",children:y}),j&&t.jsx("div",{className:"text-sm text-green-700",children:j})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"flex flex-wrap gap-2",children:["overview","questions","bands","seo","schedule","research","raw"].map(e=>t.jsx("button",{onClick:()=>m(e),className:`px-3 py-1 rounded-full border ${o===e?"bg-brand-600 text-white border-brand-600":"bg-white"}`,children:e[0].toUpperCase()+e.slice(1)},e))}),(0,t.jsxs)("div",{className:"space-x-2",children:[t.jsx("button",{onClick:S,disabled:g,className:"px-3 py-1 rounded-md bg-green-700 text-white disabled:opacity-60",children:g?"Saving...":"Save"}),t.jsx("button",{onClick:()=>x?.slug&&i(x.slug),className:"px-3 py-1 rounded-md bg-red-600 text-white",children:"Delete"})]})]}),(0,t.jsxs)("div",{className:"p-3 rounded-md border bg-white",children:["overview"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Title"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.title||"",onChange:e=>q({title:e.target.value})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Slug"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.slug||"",onChange:e=>q({slug:e.target.value})})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Description"}),t.jsx("textarea",{className:"mt-1 w-full border rounded px-2 py-1",rows:3,value:x.description||"",onChange:e=>q({description:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Cover image URL"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.imageUrl||"",onChange:e=>q({imageUrl:e.target.value})})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];s&&r&&r(s)},className:"text-sm"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Tags (comma separated)"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:(x.tags||[]).join(", "),onChange:e=>q({tags:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:!!x.isPaid,onChange:e=>q({isPaid:e.target.checked})})," Paid"]}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Price"}),t.jsx("input",{type:"number",className:"mt-1 w-full border rounded px-2 py-1",value:x.price??0,onChange:e=>q({price:Number(e.target.value)})})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Attachments (links)"}),t.jsx("button",{onClick:()=>q({attachments:[...x.attachments||[],{label:"",url:"",type:"link"}]}),className:"px-2 py-1 text-xs border rounded",children:"Add Attachment"})]}),t.jsx("div",{className:"mt-2 space-y-2",children:(x.attachments||[]).map((e,s)=>(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs text-gray-600",children:"Label"}),t.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:e.label||"",onChange:a=>{let t=[...x.attachments||[]];t[s]={...e,label:a.target.value},q({attachments:t})}})]}),(0,t.jsxs)("div",{className:"md:col-span-3",children:[t.jsx("label",{className:"block text-xs text-gray-600",children:"URL"}),t.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:e.url||"",onChange:a=>{let t=[...x.attachments||[]];t[s]={...e,url:a.target.value},q({attachments:t})}})]}),t.jsx("div",{className:"md:col-span-5 flex justify-end",children:t.jsx("button",{onClick:()=>{let e=[...x.attachments||[]];e.splice(s,1),q({attachments:e})},className:"px-2 py-1 text-xs border rounded text-red-600",children:"Remove"})})]},s))})]})]}),"questions"===o&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("h4",{className:"font-medium",children:["Questions (",x.questions?.length||0,")"]}),t.jsx("button",{onClick:()=>q({questions:[...x.questions||[],{id:`q${Date.now()}`,text:"",type:"likert",options:[]}]}),className:"px-3 py-1 rounded-md bg-brand-700 text-white",children:"Add Question"})]}),t.jsx("div",{className:"space-y-3",children:(x.questions||[]).map((e,s)=>(0,t.jsxs)("div",{className:"p-3 border rounded-md bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-sm text-gray-600",children:e.id||`q${s+1}`}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("button",{onClick:()=>D(s,-1),className:"px-2 py-1 border rounded",children:"↑"}),t.jsx("button",{onClick:()=>D(s,1),className:"px-2 py-1 border rounded",children:"↓"}),t.jsx("button",{onClick:()=>M(s),className:"px-2 py-1 border rounded text-red-600",children:"Delete"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Text"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:e.text||"",onChange:a=>U(s,{...e,text:a.target.value})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Type"}),(0,t.jsxs)("select",{className:"mt-1 w-full border rounded px-2 py-1",value:e.type||"likert",onChange:a=>U(s,{...e,type:a.target.value}),children:[t.jsx("option",{value:"likert",children:"Likert (1-5)"}),t.jsx("option",{value:"yes_no",children:"Yes / No"}),t.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),t.jsx("option",{value:"text_input",children:"Text Input"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Image URL (optional)"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:e.imageUrl||"",onChange:a=>U(s,{...e,imageUrl:a.target.value})})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];a&&n&&n(s,a)},className:"text-sm"})})]}),"multiple_choice"===e.type&&(0,t.jsxs)("div",{className:"mt-2",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Options (one per line)"}),t.jsx("textarea",{className:"mt-1 w-full border rounded px-2 py-1",rows:3,value:(e.options||[]).join("\n"),onChange:a=>U(s,{...e,options:a.target.value.split("\n").map(e=>e.trim()).filter(Boolean)})})]}),"text_input"===e.type&&(0,t.jsxs)("div",{className:"mt-2",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Placeholder (optional)"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:e.placeholder||"",onChange:a=>U(s,{...e,placeholder:a.target.value})})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Attachments (links)"}),t.jsx("button",{onClick:()=>{let a=[...x.questions||[]],t=[...e.attachments||[]];t.push({label:"",url:"",type:"link"}),a[s]={...e,attachments:t},q({questions:a})},className:"px-2 py-1 text-xs border rounded",children:"Add Attachment"})]}),t.jsx("div",{className:"mt-2 space-y-2",children:(e.attachments||[]).map((a,l)=>(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs text-gray-600",children:"Label"}),t.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:a.label||"",onChange:t=>{let i=[...x.questions||[]],r=[...e.attachments||[]];r[l]={...a,label:t.target.value},i[s]={...e,attachments:r},q({questions:i})}})]}),(0,t.jsxs)("div",{className:"md:col-span-3",children:[t.jsx("label",{className:"block text-xs text-gray-600",children:"URL"}),t.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:a.url||"",onChange:t=>{let i=[...x.questions||[]],r=[...e.attachments||[]];r[l]={...a,url:t.target.value},i[s]={...e,attachments:r},q({questions:i})}})]}),t.jsx("div",{className:"md:col-span-5 flex justify-end",children:t.jsx("button",{onClick:()=>{let a=[...x.questions||[]],t=[...e.attachments||[]];t.splice(l,1),a[s]={...e,attachments:t},q({questions:a})},className:"px-2 py-1 text-xs border rounded text-red-600",children:"Remove"})})]},l))})]})]},e.id||s))})]}),"bands"===o&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("h4",{className:"font-medium",children:["Bands (",x.bands?.length||0,")"]}),t.jsx("button",{onClick:()=>q({bands:[...x.bands||[],{min:0,max:0,label:"",advice:""}]}),className:"px-3 py-1 rounded-md bg-brand-700 text-white",children:"Add Band"})]}),t.jsx("div",{className:"space-y-3",children:(x.bands||[]).map((e,s)=>(0,t.jsxs)("div",{className:"p-3 border rounded-md bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Band #",s+1]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("button",{onClick:()=>R(s,-1),className:"px-2 py-1 border rounded",children:"↑"}),t.jsx("button",{onClick:()=>R(s,1),className:"px-2 py-1 border rounded",children:"↓"}),t.jsx("button",{onClick:()=>L(s),className:"px-2 py-1 border rounded text-red-600",children:"Delete"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Min"}),t.jsx("input",{type:"number",className:"mt-1 w-full border rounded px-2 py-1",value:e.min??0,onChange:a=>P(s,{...e,min:Number(a.target.value)})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Max"}),t.jsx("input",{type:"number",className:"mt-1 w-full border rounded px-2 py-1",value:e.max??0,onChange:a=>P(s,{...e,max:Number(a.target.value)})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Label"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:e.label||"",onChange:a=>P(s,{...e,label:a.target.value})})]}),t.jsx("div",{className:"md:col-span-1"})]}),(0,t.jsxs)("div",{className:"mt-2",children:[t.jsx("label",{className:"block text-sm font-medium",children:"Advice"}),t.jsx("textarea",{className:"mt-1 w-full border rounded px-2 py-1",rows:2,value:e.advice||"",onChange:a=>P(s,{...e,advice:a.target.value})})]})]},s))})]}),"seo"===o&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Meta Title"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.metaTitle||"",onChange:e=>q({metaTitle:e.target.value})}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[(x.metaTitle||"").length," / 70"]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Canonical URL"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.canonicalUrl||"",onChange:e=>q({canonicalUrl:e.target.value})})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Meta Description"}),t.jsx("textarea",{className:"mt-1 w-full border rounded px-2 py-1",rows:3,value:x.metaDescription||"",onChange:e=>q({metaDescription:e.target.value})}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[(x.metaDescription||"").length," / 160"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Keywords (comma separated)"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:(x.keywords||[]).join(", "),onChange:e=>q({keywords:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"OG Image URL"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.ogImage||"",onChange:e=>q({ogImage:e.target.value})})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Robots"}),t.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",value:x.robots||"",onChange:e=>q({robots:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[d&&t.jsx("button",{onClick:()=>{let e=d(x);e&&q(e),v("Meta generated. Review and Save.")},className:"px-3 py-1 rounded-md bg-sky-700 text-white",children:"Generate Meta"}),c&&t.jsx("button",{onClick:()=>{let e=c(x);e?f(e):v("Meta looks good.")},className:"px-3 py-1 rounded-md bg-amber-700 text-white",children:"Validate Meta"})]})]}),"schedule"===o&&(0,t.jsxs)("div",{className:"space-y-3",children:[t.jsx("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:!1!==x.published,onChange:e=>q({published:e.target.checked})})," Published"]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("label",{className:"text-sm font-medium",children:"Publish at"}),t.jsx("input",{type:"datetime-local",value:h,onChange:e=>p(e.target.value),className:"text-sm border rounded px-2 py-1"}),t.jsx("button",{onClick:()=>{if(h)q({publishedAt:new Date(h).toISOString()});else{let{publishedAt:e,...s}=x;q(s)}},className:"px-3 py-1 rounded-md bg-blue-600 text-white",children:"Apply Schedule"}),t.jsx("button",{onClick:()=>{q({published:!0,publishedAt:new Date().toISOString()})},className:"px-3 py-1 rounded-md bg-green-700 text-white",children:"Publish Now"})]})]}),"research"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Time Range"}),(0,t.jsxs)("select",{value:k,onChange:e=>C(e.target.value),className:"px-3 py-2 border rounded-md text-sm",children:[t.jsx("option",{value:"24h",children:"Last 24h"}),t.jsx("option",{value:"7d",children:"Last 7d"}),t.jsx("option",{value:"30d",children:"Last 30d"}),t.jsx("option",{value:"90d",children:"Last 90d"}),t.jsx("option",{value:"all",children:"All time"})]}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx("button",{onClick:()=>z("json"),className:"px-3 py-1 rounded-md border",children:"Export JSON"}),t.jsx("button",{onClick:()=>z("csv"),className:"px-3 py-1 rounded-md border",children:"Export CSV"}),t.jsx("button",{onClick:A,className:"px-3 py-1 rounded-md bg-brand-700 text-white",children:"Download Report"})]})]}),N?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-3 border rounded-md bg-white",children:[t.jsx("h4",{className:"font-medium mb-2",children:"Performance"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Total Completions"}),t.jsx("span",{children:N.totalCompletions})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Average Score"}),t.jsx("span",{children:N.averageScore?.toFixed?.(1)??N.averageScore})]})]})]}),(0,t.jsxs)("div",{className:"p-3 border rounded-md bg-white",children:[t.jsx("h4",{className:"font-medium mb-2",children:"Score Distribution"}),t.jsx("div",{className:"space-y-1 text-sm",children:Object.entries(N.scoreDistribution||{}).map(([e,s])=>(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{children:e}),t.jsx("span",{children:s})]},e))})]}),(0,t.jsxs)("div",{className:"md:col-span-2 p-3 border rounded-md bg-white",children:[t.jsx("h4",{className:"font-medium mb-2",children:"Top Questions"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(N.questionStats||{}).slice(0,6).map(([e,s])=>(0,t.jsxs)("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium",children:s.questionText}),(0,t.jsxs)("div",{className:"text-gray-600",children:["Avg: ","number"==typeof s.averageResponse?s.averageResponse.toFixed(2):"-"," | Responses: ",Object.values(s.responseDistribution||{}).reduce((e,s)=>e+s,0)]})]},e))})]}),(0,t.jsxs)("div",{className:"md:col-span-2 p-3 border rounded-md bg-white",children:[t.jsx("h4",{className:"font-medium mb-2",children:"Completion Trend (Daily)"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-7 gap-2 text-sm text-gray-700",children:(N.completionTrend||[]).slice(-7).map(e=>(0,t.jsxs)("div",{className:"p-2 border rounded",children:[t.jsx("div",{className:"text-xs text-gray-500",children:e.date}),t.jsx("div",{className:"font-medium",children:e.count})]},e.date))})]})]}):t.jsx("div",{className:"text-sm text-gray-500",children:"Loading insights..."})]}),"raw"===o&&(0,t.jsxs)("div",{children:[t.jsx("textarea",{className:"w-full h-[50vh] border rounded-md p-2 font-mono text-sm",value:JSON.stringify(x,null,2),onChange:e=>{try{let a=JSON.parse(e.target.value);u(a),s(a)}catch{}}}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Directly editing raw JSON will update the form if the JSON is valid."})]})]})]})}function r(){let[e,s]=(0,l.useState)([]),[a,r]=(0,l.useState)(""),[n,d]=(0,l.useState)(null),[c,o]=(0,l.useState)(""),[m,x]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!0),[b,j]=(0,l.useState)(!1),[v,y]=(0,l.useState)(""),f=async()=>{g(!0);try{let e=await fetch("/api/admin/quizzes");if(!e.ok)throw Error("Failed to load");let t=await e.json();if(s(t.items||[]),!a&&(t.items?.length??0)>0)r(t.items[0].slug),d(t.items[0]);else if(a){let e=(t.items||[]).find(e=>e.slug===a);e&&d(e)}}catch(e){o(e?.message||"Failed to load")}finally{g(!1)}},N=async(e,s)=>{if(s&&n){y(""),j(!0);try{let a=new FormData;a.append("file",s);let t=await fetch("/api/upload",{method:"POST",body:a}),l=await t.json();if(!t.ok||!l?.imageUrl)throw Error(l?.error||"Upload failed");d(s=>{let a={...s||{},questions:[...s?.questions||[]]};return a.questions[e]?(a.questions[e]={...a.questions[e],imageUrl:l.imageUrl},a):s})}catch(e){y(e?.message||"Upload failed")}finally{j(!1)}}},w=e=>{let s="http://localhost:3000",a=e.title||"",t=e.description||e.metaDescription||"",l=e.metaTitle||`${a} | MyBeing Quiz`,i=(e.metaDescription||t||"").toString().replace(/\s+/g," ").trim().slice(0,160),r=Array.isArray(e.keywords)&&e.keywords.length?e.keywords:Array.from(new Set([...e.tags||[],"quiz","assessment","psychology","patterns"])).slice(0,8),n=e.canonicalUrl||`${s}/quizzes/${e.slug}`,d=e.ogImage||`${s}/api/og?title=${encodeURIComponent(a)}&subtitle=${encodeURIComponent(i)}`,c=e.robots||"index,follow";return{...e,metaTitle:l,metaDescription:i,keywords:r,canonicalUrl:n,ogImage:d,robots:c}},k=e=>{let s=[];return e.slug||s.push("Missing slug"),e.title||s.push("Missing title"),Array.isArray(e.questions)||s.push("questions[] missing"),Array.isArray(e.bands)||s.push("bands[] missing"),e.published&&!e.publishedAt&&s.push("Published items should have publishedAt"),e.metaTitle||s.push("Missing metaTitle"),(e.metaTitle||"").length>70&&s.push("metaTitle should be <= 70 chars"),e.metaDescription||s.push("Missing metaDescription"),(e.metaDescription||"").length>160&&s.push("metaDescription should be <= 160 chars"),e.canonicalUrl||s.push("Missing canonicalUrl"),Array.isArray(e.keywords)||s.push("keywords should be an array"),s.length?"Meta validation failed:\n- "+s.join("\n- "):null},C=s=>{r(s),d(e.find(e=>e.slug===s)||null),x(""),o("")},q=async e=>{if(e){y(""),j(!0);try{let s=new FormData;s.append("file",e);let a=await fetch("/api/upload",{method:"POST",body:s}),t=await a.json();if(!a.ok||!t?.imageUrl)throw Error(t?.error||"Upload failed");d(e=>({...e||{},imageUrl:t.imageUrl}))}catch(e){y(e?.message||"Upload failed")}finally{j(!1)}}},S=async e=>{if(!e.slug||!e.title||!Array.isArray(e.questions)||!Array.isArray(e.bands))throw Error("slug, title, questions[], and bands[] are required");let s=await fetch("/api/admin/quizzes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e?.error||"Save failed")}await f()},z=async()=>{if(a&&confirm(`Delete quiz ${a}?`))try{if(!(await fetch(`/api/admin/quizzes?slug=${encodeURIComponent(a)}`,{method:"DELETE"})).ok)throw Error("Delete failed");r(""),d(null),await f()}catch(e){o(e?.message||"Delete failed")}};return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h2",{className:"font-medium",children:"Quizzes"}),t.jsx("button",{onClick:()=>{let e={slug:"new-quiz",title:"New Quiz",description:"Description...",imageUrl:"",questions:[],bands:[],published:!1,publishedAt:void 0,tags:[],isPaid:!1,price:0,metaTitle:"",metaDescription:"",keywords:[],canonicalUrl:"",ogImage:"",robots:"index,follow"};r(e.slug),d(e),o(""),x("")},className:"px-3 py-1 rounded-md bg-brand-700 text-white",children:"New"})]}),(0,t.jsxs)("div",{className:"border rounded-md divide-y max-h-[60vh] overflow-auto",children:[p&&t.jsx("div",{className:"p-2 text-sm text-gray-500",children:"Loading..."}),e.map(e=>t.jsx("button",{onClick:()=>C(e.slug),className:`w-full text-left p-2 hover:bg-brand-50 ${a===e.slug?"bg-brand-100":""}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("div",{className:"font-medium",children:e.title}),t.jsx("div",{className:"text-xs text-gray-500",children:e.slug})]}),t.jsx("div",{className:"text-xs",children:!1!==e.published?"Published":"Draft"})]})},e.slug))]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[c&&t.jsx("div",{className:"text-sm text-red-600 mb-2 whitespace-pre-wrap",children:c}),m&&t.jsx("div",{className:"text-sm text-green-700 mb-2",children:m}),n?t.jsx(i,{value:n,onChange:e=>d(e),onSave:async e=>{h(!0);try{await S(e),x("Saved.")}catch(e){o(e?.message||"Save failed")}finally{h(!1)}},onDelete:async e=>{await z()},onUploadImage:q,onUploadQuestionImage:N,onGenerateMeta:e=>w(e),onValidateMeta:e=>k(e)}):t.jsx("div",{className:"p-6 text-sm text-gray-500 border rounded-md bg-white",children:"Select a quiz or click New to start."}),v&&t.jsx("span",{className:"text-xs text-red-600 block mt-2",children:v})]})]})}},57311:(e,s,a)=>{"use strict";a.d(s,{WorldClassAdminLayout:()=>y});var t=a(10326),l=a(17577),i=a(86462),r=a(81849),n=a(24319),d=a(36283),c=a(98360),o=a(26754),m=a(24061),x=a(66697),u=a(88307),h=a(83855),p=a(6507),g=a(71810),b=a(3679),j=a(85833);let v=[{name:"Dashboard",href:"/admin",icon:n.Z,current:!0},{name:"Articles",href:"/admin/articles",icon:d.Z,current:!1},{name:"Quizzes",href:"/admin/quizzes",icon:c.Z,current:!1},{name:"Analytics",href:"/admin/analytics",icon:o.Z,current:!1},{name:"Users",href:"/admin/users",icon:m.Z,current:!1},{name:"Research",href:"/admin/research",icon:x.Z,current:!1}];function y({children:e,user:s,activeSection:a="dashboard"}){let[n,d]=(0,l.useState)(!1);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(i.M,{children:n&&t.jsx(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 lg:hidden",onClick:()=>d(!1),children:t.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75"})})}),t.jsx("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl lg:shadow-none lg:static lg:inset-0 lg:z-auto lg:w-20 lg:hover:w-64 transition-all duration-300 ease-in-out",children:(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex items-center justify-center h-16 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-white font-bold text-sm",children:"MB"})}),t.jsx("span",{className:"hidden lg:block lg:opacity-0 lg:group-hover:opacity-100 transition-opacity font-semibold text-gray-900",children:"MyBeing Admin"})]})}),t.jsx("nav",{className:"flex-1 space-y-1 px-3 py-4",children:v.map(e=>(0,t.jsxs)(r.E.a,{href:e.href,className:`group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 ${a===e.name.toLowerCase()?"bg-purple-50 text-purple-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(e.icon,{className:"h-5 w-5 flex-shrink-0"}),t.jsx("span",{className:"ml-3 hidden lg:group-hover:block",children:e.name})]},e.name))}),t.jsx("div",{className:"border-t border-gray-200 p-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"h-8 w-8 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-white font-bold text-sm",children:s.name.charAt(0)}),(0,t.jsxs)("div",{className:"hidden lg:group-hover:block",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),t.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]})})]})}),(0,t.jsxs)("div",{className:"lg:pl-20",children:[t.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:t.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("button",{type:"button",className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",onClick:()=>d(!0),children:[t.jsx("span",{className:"sr-only",children:"Open sidebar"}),t.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),t.jsx("div",{className:"flex items-center space-x-4",children:(0,t.jsxs)("div",{className:"relative",children:[t.jsx(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search content...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(b.z,{variant:"ghost",size:"sm",className:"hidden sm:flex items-center space-x-2",children:[t.jsx(h.Z,{className:"h-4 w-4"}),t.jsx("span",{children:"New Content"})]}),t.jsx("div",{className:"relative",children:(0,t.jsxs)(b.z,{variant:"ghost",size:"sm",className:"relative",children:[t.jsx(p.Z,{className:"h-5 w-5"}),t.jsx(j.C,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 w-4 p-0 text-xs",children:"3"})]})}),t.jsx(b.z,{variant:"ghost",size:"sm",children:t.jsx(g.Z,{className:"h-4 w-4"})})]})]})})}),t.jsx("main",{className:"flex-1",children:t.jsx("div",{className:"py-6",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e})})})]})]})}},85833:(e,s,a)=>{"use strict";a.d(s,{C:()=>c});var t=a(10326),l=a(17577),i=a(77863);let r={default:"bg-gray-100 text-gray-800 border-gray-200",secondary:"bg-gray-600 text-white border-gray-600",success:"bg-green-100 text-green-800 border-green-200",warning:"bg-yellow-100 text-yellow-800 border-yellow-200",error:"bg-red-100 text-red-800 border-red-200",brand:"bg-lilac-100 text-lilac-800 border-lilac-200",outline:"bg-transparent text-gray-600 border-gray-300",premium:"bg-gradient-to-r from-lilac-100 to-lilac-50 text-lilac-800 border-lilac-200"},n={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-1 text-xs",md:"px-2.5 py-1 text-sm",lg:"px-3 py-1.5 text-sm"},d={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"},c=(0,l.forwardRef)(({className:e,variant:s="default",size:a="sm",rounded:l="md",animated:c=!1,pulse:o=!1,children:m,...x},u)=>t.jsx("span",{ref:u,className:(0,i.cn)("inline-flex items-center font-medium border transition-all duration-200",r[s],n[a],d[l],c&&"hover:scale-105 hover:shadow-sm",o&&"animate-pulse",e),...x,children:m}));c.displayName="Badge"},98360:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]])},83855:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},88307:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},26705:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d,dynamic:()=>n});var t=a(19510),l=a(3360),i=a(44057);let r=(0,a(68570).createProxy)(String.raw`/Users/niharikasai/mybeing/components/admin/AdminQuizzes.tsx#default`),n="force-dynamic";function d(){(0,l.kF)();let e={name:"MyBeing Creator",email:process.env.ADMIN_EMAIL||"creator@mybeing.in"};return t.jsx(i.V,{user:e,activeSection:"quizzes",children:(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quizzes"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage research-backed self-discovery quizzes"})]})}),t.jsx(r,{})]})})}},44057:(e,s,a)=>{"use strict";a.d(s,{V:()=>t});let t=(0,a(68570).createProxy)(String.raw`/Users/niharikasai/mybeing/components/admin/WorldClassAdminLayout.tsx#WorldClassAdminLayout`)},3360:(e,s,a)=>{"use strict";a.d(s,{DK:()=>n,YH:()=>d,bc:()=>c,kF:()=>r});var t=a(71615),l=a(58585);let i="admin_auth";function r(){let e=(0,t.cookies)();e.get("admin_token")?.value||(0,l.redirect)("/admin/login")}function n(e){return!!e.cookies.get("admin_token")?.value||"1"===e.cookies.get(i)?.value}function d(){let e=new Headers;return e.append("Set-Cookie",`${i}=; Path=/; HttpOnly; Max-Age=0; SameSite=Lax; Secure`),e}function c(){let e=new Headers;return e.append("Set-Cookie",`${i}=1; Path=/; HttpOnly; SameSite=Lax; Secure; Max-Age=86400`),e}}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[8948,1907,4261,4054,9925,8049],()=>a(25486));module.exports=t})();